"use strict";(self["webpackChunkmini_notes_ui"]=self["webpackChunkmini_notes_ui"]||[]).push([[168],{1974:function(e,t,l){l.r(t),l.d(t,{default:function(){return Qt}});var i=l(6768),s=l(5130),o=l(4232),a=l(365);const c={class:"page-detail"},n={class:"page-detail__header"},d={class:"page-detail__title-wrapper"},r={class:"page-detail__content"},u={key:0,class:"page-detail__loading"};function k(e,t,l,k,p,b){const h=(0,i.g2)("EmptyState"),m=(0,i.g2)("BlockRenderer"),_=(0,i.g2)("BlockTypeSelector"),v=(0,i.g2)("ConfirmDialog");return(0,i.uX)(),(0,i.CE)("div",c,[(0,i.Lk)("div",n,[(0,i.Lk)("button",{class:"page-detail__back",onClick:t[0]||(t[0]=(...e)=>b.goBack&&b.goBack(...e))},[(0,i.bF)(a.w,{icon:"mdi-arrow-left",size:"24"})]),(0,i.Lk)("div",d,[p.editingTitle?(0,i.bo)(((0,i.uX)(),(0,i.CE)("input",{key:0,ref:"titleInput","onUpdate:modelValue":t[1]||(t[1]=e=>p.titleDraft=e),type:"text",class:"page-detail__title-input",maxlength:"200",onBlur:t[2]||(t[2]=(...e)=>b.saveTitle&&b.saveTitle(...e)),onKeyup:[t[3]||(t[3]=(0,s.jR)((...e)=>b.saveTitle&&b.saveTitle(...e),["enter"])),t[4]||(t[4]=(0,s.jR)((...e)=>b.cancelTitleEdit&&b.cancelTitleEdit(...e),["escape"]))]},null,544)),[[s.Jo,p.titleDraft]]):((0,i.uX)(),(0,i.CE)("h1",{key:1,class:"page-detail__title",onClick:t[5]||(t[5]=(...e)=>b.startTitleEdit&&b.startTitleEdit(...e))},(0,o.v_)(p.page?.title||"Загрузка..."),1))]),(0,i.Lk)("button",{class:"page-detail__delete",onClick:t[6]||(t[6]=e=>p.showDeleteConfirm=!0)},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"22"})])]),(0,i.Lk)("div",r,[p.loading?((0,i.uX)(),(0,i.CE)("div",u,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(3,e=>(0,i.Lk)("div",{class:"page-detail__loading-block",key:e})),64))])):p.page?.blocks?.length?((0,i.uX)(),(0,i.Wv)(s.F,{key:2,name:"fade-up",tag:"div",class:"page-detail__blocks"},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.page.blocks,(e,t)=>((0,i.uX)(),(0,i.Wv)(m,{key:e.id,block:e,"page-id":b.pageId,style:(0,o.Tr)({transitionDelay:.03*t+"s"}),onUpdate:e=>b.updateBlock(t,e),onDelete:l=>b.deleteBlock(e,t)},null,8,["block","page-id","style","onUpdate","onDelete"]))),128))]),_:1})):((0,i.uX)(),(0,i.Wv)(h,{key:1,icon:"mdi-text-box-plus-outline",title:"Нет блоков",subtitle:"Добавьте первый блок в заметку","action-text":"Добавить блок",onAction:t[7]||(t[7]=e=>p.showBlockSelector=!0)}))]),(0,i.Lk)("button",{class:"page-detail__fab",onClick:t[8]||(t[8]=e=>p.showBlockSelector=!0)},[(0,i.bF)(a.w,{icon:"mdi-plus",size:"28"})]),(0,i.bF)(_,{show:p.showBlockSelector,"block-types":p.blockTypes,"is-premium":p.isPremium,onClose:t[9]||(t[9]=e=>p.showBlockSelector=!1),onSelect:b.createBlock},null,8,["show","block-types","is-premium","onSelect"]),(0,i.bF)(v,{show:p.showDeleteConfirm,title:"Удалить страницу?",message:"Страница и все её блоки будут удалены безвозвратно.","confirm-text":"Удалить",danger:!0,onConfirm:b.deletePage,onCancel:t[10]||(t[10]=e=>p.showDeleteConfirm=!1)},null,8,["show","onConfirm"]),(0,i.bF)(v,{show:p.showBlockDeleteConfirm,title:"Удалить блок?",message:"Блок будет удален безвозвратно.","confirm-text":"Удалить",danger:!0,onConfirm:b.confirmDeleteBlock,onCancel:b.cancelDeleteBlock},null,8,["show","onConfirm","onCancel"])])}l(4114);function p(e,t,l,s,o,a){return(0,i.uX)(),(0,i.Wv)((0,i.$y)(a.blockComponent),{block:l.block,"page-id":l.pageId,onUpdate:t[0]||(t[0]=t=>e.$emit("update",t)),onDelete:t[1]||(t[1]=t=>e.$emit("delete"))},null,40,["block","page-id"])}const b={class:"text-block__content"},h={key:1,class:"text-block__edit"};function m(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["text-block",{"text-block--editing":n.editing}])},[n.editing?((0,i.uX)(),(0,i.CE)("div",h,[(0,i.bo)((0,i.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draft=e),class:"text-block__textarea",placeholder:"Введите текст...",rows:"3",onBlur:t[3]||(t[3]=(...e)=>d.save&&d.save(...e)),onKeydown:t[4]||(t[4]=(0,s.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))},null,544),[[s.Jo,n.draft]])])):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"text-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,i.Lk)("p",b,(0,o.v_)(l.block.textContent||"Нажмите для редактирования..."),1),(0,i.Lk)("button",{class:"text-block__delete",onClick:t[0]||(t[0]=(0,s.D$)(t=>e.$emit("delete"),["stop"]))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]))],2)}var _=l(1668),v={name:"TextBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draft:""}},methods:{startEdit(){this.draft=this.block.textContent||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draft!==this.block.textContent){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"TEXT",textContent:this.draft}),this.$emit("update",{...this.block,textContent:this.draft})}catch(e){console.error("Failed to update block:",e)}this.editing=!1}else this.editing=!1},cancel(){this.editing=!1}}},f=l(1241);const g=(0,f.A)(v,[["render",m],["__scopeId","data-v-120e6356"]]);var y=g;const C={key:1,class:"heading-block__edit"},x={class:"heading-block__levels"},I=["onClick"];function L(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["heading-block",{"heading-block--editing":n.editing}])},[n.editing?((0,i.uX)(),(0,i.CE)("div",C,[(0,i.Lk)("div",x,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(3,e=>(0,i.Lk)("button",{key:e,class:(0,o.C4)(["heading-block__level",{"heading-block__level--active":n.draftLevel===e}]),onClick:t=>n.draftLevel=e}," H"+(0,o.v_)(e),11,I)),64))]),(0,i.bo)((0,i.Lk)("input",{ref:"input","onUpdate:modelValue":t[2]||(t[2]=e=>n.draftHeader=e),type:"text",class:(0,o.C4)(["heading-block__input","heading-block__input--h"+n.draftLevel]),placeholder:"Введите заголовок...",onBlur:t[3]||(t[3]=(...e)=>d.save&&d.save(...e)),onKeyup:[t[4]||(t[4]=(0,s.jR)((...e)=>d.save&&d.save(...e),["enter"])),t[5]||(t[5]=(0,s.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))]},null,34),[[s.Jo,n.draftHeader]])])):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"heading-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[((0,i.uX)(),(0,i.Wv)((0,i.$y)("h"+l.block.level),{class:(0,o.C4)(["heading-block__text","heading-block__text--h"+l.block.level])},{default:(0,i.k6)(()=>[(0,i.eW)((0,o.v_)(l.block.header||"Заголовок"),1)]),_:1},8,["class"])),(0,i.Lk)("button",{class:"heading-block__delete",onClick:t[0]||(t[0]=(0,s.D$)(t=>e.$emit("delete"),["stop"]))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]))],2)}var w={name:"HeadingBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draftHeader:"",draftLevel:1}},methods:{startEdit(){this.draftHeader=this.block.header||"",this.draftLevel=this.block.level||1,this.editing=!0,this.$nextTick(()=>{this.$refs.input?.focus()})},async save(){if(this.draftHeader!==this.block.header||this.draftLevel!==this.block.level){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"HEADING",header:this.draftHeader,level:this.draftLevel}),this.$emit("update",{...this.block,header:this.draftHeader,level:this.draftLevel})}catch(e){console.error("Failed to update heading:",e)}this.editing=!1}else this.editing=!1},cancel(){this.editing=!1}}};const E=(0,f.A)(w,[["render",L],["__scopeId","data-v-057034de"]]);var T=E;const B={class:"divider-block"};function D(e,t,l,s,o,c){return(0,i.uX)(),(0,i.CE)("div",B,[t[1]||(t[1]=(0,i.Lk)("div",{class:"divider-block__line"},null,-1)),(0,i.Lk)("button",{class:"divider-block__delete",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"16"})])])}var F={name:"DividerBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"]};const S=(0,f.A)(F,[["render",D],["__scopeId","data-v-32fda84d"]]);var X=S;const $={class:"checklist-block"},U={class:"checklist-block__header"},A={class:"checklist-block__items"},z=["onClick"],q=["onUpdate:modelValue","onKeyup"],K=["onClick"];function R(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",$,[(0,i.Lk)("div",U,[(0,i.bF)(a.w,{icon:"mdi-checkbox-marked-outline",size:"18",class:"checklist-block__icon"}),t[3]||(t[3]=(0,i.Lk)("span",{class:"checklist-block__label"},"Чек-лист",-1)),(0,i.Lk)("button",{class:"checklist-block__delete",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]),(0,i.Lk)("div",A,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.items,(e,l)=>((0,i.uX)(),(0,i.CE)("div",{key:l,class:"checklist-block__item"},[(0,i.Lk)("button",{class:(0,o.C4)(["checklist-block__checkbox",{"checklist-block__checkbox--checked":e.status}]),onClick:e=>d.toggleItem(l)},[(0,i.bF)(a.w,{icon:e.status?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",size:"22"},null,8,["icon"])],10,z),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t=>e.text=t,type:"text",class:(0,o.C4)(["checklist-block__input",{"checklist-block__input--done":e.status}]),placeholder:"Новый пункт...",onBlur:t[1]||(t[1]=(...e)=>d.saveItems&&d.saveItems(...e)),onKeyup:(0,s.jR)(e=>d.addItem(l+1),["enter"])},null,42,q),[[s.Jo,e.text]]),n.items.length>1?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"checklist-block__remove",onClick:e=>d.removeItem(l)},[(0,i.bF)(a.w,{icon:"mdi-close",size:"16"})],8,K)):(0,i.Q3)("",!0)]))),128))]),(0,i.Lk)("button",{class:"checklist-block__add",onClick:t[2]||(t[2]=e=>d.addItem())},[(0,i.bF)(a.w,{icon:"mdi-plus",size:"18"}),t[4]||(t[4]=(0,i.eW)(" Добавить пункт ",-1))])])}l(8111),l(2489),l(1701),l(3579);var P={name:"ChecklistBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{items:[]}},watch:{block:{immediate:!0,handler(e){this.items=e.items?.map(e=>({...e}))||[{text:"",status:!1}]}}},methods:{async toggleItem(e){this.items[e].status=!this.items[e].status,await this.saveItems()},addItem(e){const t=e??this.items.length;this.items.splice(t,0,{text:"",status:!1}),this.$nextTick(()=>{const e=this.$el.querySelectorAll(".checklist-block__input");e[t]?.focus()})},async removeItem(e){this.items.splice(e,1),0===this.items.length&&this.items.push({text:"",status:!1}),await this.saveItems()},async saveItems(){const e=this.items.filter(e=>e.text.trim());if(0!==e.length||!this.items.some(e=>!e.text.trim()))try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"CHECKLIST",items:this.items.map(e=>({text:e.text,status:e.status}))}),this.$emit("update",{...this.block,items:[...this.items]})}catch(t){console.error("Failed to update checklist:",t)}}}};const V=(0,f.A)(P,[["render",R],["__scopeId","data-v-5bd5ed52"]]);var O=V;const j={class:"bullet-block"},Q={class:"bullet-block__header"},H={class:"bullet-block__items"},N=["onUpdate:modelValue","onKeyup"],J=["onClick"];function W(e,t,l,o,c,n){return(0,i.uX)(),(0,i.CE)("div",j,[(0,i.Lk)("div",Q,[(0,i.bF)(a.w,{icon:"mdi-format-list-bulleted",size:"18",class:"bullet-block__icon"}),t[3]||(t[3]=(0,i.Lk)("span",{class:"bullet-block__label"},"Список",-1)),(0,i.Lk)("button",{class:"bullet-block__delete",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]),(0,i.Lk)("div",H,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.items,(e,l)=>((0,i.uX)(),(0,i.CE)("div",{key:l,class:"bullet-block__item"},[t[4]||(t[4]=(0,i.Lk)("span",{class:"bullet-block__bullet"},null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e=>c.items[l]=e,type:"text",class:"bullet-block__input",placeholder:"Новый пункт...",onBlur:t[1]||(t[1]=(...e)=>n.saveItems&&n.saveItems(...e)),onKeyup:(0,s.jR)(e=>n.addItem(l+1),["enter"])},null,40,N),[[s.Jo,c.items[l]]]),c.items.length>1?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"bullet-block__remove",onClick:e=>n.removeItem(l)},[(0,i.bF)(a.w,{icon:"mdi-close",size:"16"})],8,J)):(0,i.Q3)("",!0)]))),128))]),(0,i.Lk)("button",{class:"bullet-block__add",onClick:t[2]||(t[2]=e=>n.addItem())},[(0,i.bF)(a.w,{icon:"mdi-plus",size:"18"}),t[5]||(t[5]=(0,i.eW)(" Добавить пункт ",-1))])])}var M={name:"BulletListBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{items:[]}},watch:{block:{immediate:!0,handler(e){this.items=e.items?.length?[...e.items]:[""]}}},methods:{addItem(e){const t=e??this.items.length;this.items.splice(t,0,""),this.$nextTick(()=>{const e=this.$el.querySelectorAll(".bullet-block__input");e[t]?.focus()})},async removeItem(e){this.items.splice(e,1),0===this.items.length&&this.items.push(""),await this.saveItems()},async saveItems(){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"BULLET_LIST",items:this.items}),this.$emit("update",{...this.block,items:[...this.items]})}catch(e){console.error("Failed to update bullet list:",e)}}}};const G=(0,f.A)(M,[["render",W],["__scopeId","data-v-2a9bc711"]]);var Y=G;const Z={class:"kv-block"},ee={class:"kv-block__header"},te={class:"kv-block__items"},le=["onUpdate:modelValue"],ie=["onUpdate:modelValue","onKeyup"],se=["onClick"];function oe(e,t,l,o,c,n){return(0,i.uX)(),(0,i.CE)("div",Z,[(0,i.Lk)("div",ee,[(0,i.bF)(a.w,{icon:"mdi-table-row",size:"18",class:"kv-block__icon"}),t[4]||(t[4]=(0,i.Lk)("span",{class:"kv-block__label"},"Ключ-значение",-1)),(0,i.Lk)("button",{class:"kv-block__delete",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]),(0,i.Lk)("div",te,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.items,(e,l)=>((0,i.uX)(),(0,i.CE)("div",{key:l,class:"kv-block__item"},[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,type:"text",class:"kv-block__key",placeholder:"Ключ",onBlur:t[1]||(t[1]=(...e)=>n.saveItems&&n.saveItems(...e))},null,40,le),[[s.Jo,e.key]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t=>e.value=t,type:"text",class:"kv-block__value",placeholder:"Значение",onBlur:t[2]||(t[2]=(...e)=>n.saveItems&&n.saveItems(...e)),onKeyup:(0,s.jR)(e=>n.addItem(l+1),["enter"])},null,40,ie),[[s.Jo,e.value]]),c.items.length>1?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"kv-block__remove",onClick:e=>n.removeItem(l)},[(0,i.bF)(a.w,{icon:"mdi-close",size:"16"})],8,se)):(0,i.Q3)("",!0)]))),128))]),(0,i.Lk)("button",{class:"kv-block__add",onClick:t[3]||(t[3]=e=>n.addItem())},[(0,i.bF)(a.w,{icon:"mdi-plus",size:"18"}),t[5]||(t[5]=(0,i.eW)(" Добавить пару ",-1))])])}var ae={name:"KeyValueBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{items:[]}},watch:{block:{immediate:!0,handler(e){this.items=e.items?.map(e=>({...e}))||[{key:"",value:""}]}}},methods:{addItem(e){const t=e??this.items.length;this.items.splice(t,0,{key:"",value:""}),this.$nextTick(()=>{const e=this.$el.querySelectorAll(".kv-block__key");e[t]?.focus()})},async removeItem(e){this.items.splice(e,1),0===this.items.length&&this.items.push({key:"",value:""}),await this.saveItems()},async saveItems(){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"KEY_VALUE",items:this.items.map(e=>({key:e.key,value:e.value}))}),this.$emit("update",{...this.block,items:[...this.items]})}catch(e){console.error("Failed to update key-value:",e)}}}};const ce=(0,f.A)(ae,[["render",oe],["__scopeId","data-v-56fdae65"]]);var ne=ce;const de={class:"idea-block"},re={class:"idea-block__header"},ue={class:"idea-block__fields"},ke={class:"idea-block__field"},pe={class:"idea-block__field"},be={class:"idea-block__field"},he={class:"idea-block__field"},me={class:"idea-block__field"};function _e(e,t,l,o,c,n){return(0,i.uX)(),(0,i.CE)("div",de,[(0,i.Lk)("div",re,[(0,i.bF)(a.w,{icon:"mdi-lightbulb-outline",size:"18",class:"idea-block__icon"}),t[11]||(t[11]=(0,i.Lk)("span",{class:"idea-block__label"},"Карточка идеи",-1)),(0,i.Lk)("button",{class:"idea-block__delete",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]),(0,i.Lk)("div",ue,[(0,i.Lk)("div",ke,[t[12]||(t[12]=(0,i.Lk)("label",{class:"idea-block__field-label"},"Проблема",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.draft.problem=e),class:"idea-block__textarea",placeholder:"Какую проблему решает?",rows:"2",onBlur:t[2]||(t[2]=(...e)=>n.save&&n.save(...e))},null,544),[[s.Jo,c.draft.problem]])]),(0,i.Lk)("div",pe,[t[13]||(t[13]=(0,i.Lk)("label",{class:"idea-block__field-label"},"Решение",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>c.draft.solution=e),class:"idea-block__textarea",placeholder:"Как решить проблему?",rows:"2",onBlur:t[4]||(t[4]=(...e)=>n.save&&n.save(...e))},null,544),[[s.Jo,c.draft.solution]])]),(0,i.Lk)("div",be,[t[14]||(t[14]=(0,i.Lk)("label",{class:"idea-block__field-label"},"Аудитория",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>c.draft.audience=e),type:"text",class:"idea-block__input",placeholder:"Целевая аудитория",onBlur:t[6]||(t[6]=(...e)=>n.save&&n.save(...e))},null,544),[[s.Jo,c.draft.audience]])]),(0,i.Lk)("div",he,[t[15]||(t[15]=(0,i.Lk)("label",{class:"idea-block__field-label"},"MVP",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>c.draft.mvp=e),class:"idea-block__textarea",placeholder:"Минимальный продукт",rows:"2",onBlur:t[8]||(t[8]=(...e)=>n.save&&n.save(...e))},null,544),[[s.Jo,c.draft.mvp]])]),(0,i.Lk)("div",me,[t[16]||(t[16]=(0,i.Lk)("label",{class:"idea-block__field-label"},"Монетизация",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>c.draft.monetization=e),type:"text",class:"idea-block__input",placeholder:"Как заработать?",onBlur:t[10]||(t[10]=(...e)=>n.save&&n.save(...e))},null,544),[[s.Jo,c.draft.monetization]])])])])}var ve={name:"IdeaCardBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{draft:{problem:"",solution:"",audience:"",mvp:"",monetization:""}}},watch:{block:{immediate:!0,handler(e){this.draft={problem:e.problem||"",solution:e.solution||"",audience:e.audience||"",mvp:e.mvp||"",monetization:e.monetization||""}}}},methods:{async save(){const e=this.draft.problem!==this.block.problem||this.draft.solution!==this.block.solution||this.draft.audience!==this.block.audience||this.draft.mvp!==this.block.mvp||this.draft.monetization!==this.block.monetization;if(e)try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"IDEA_CARD",...this.draft}),this.$emit("update",{...this.block,...this.draft})}catch(t){console.error("Failed to update idea:",t)}}}};const fe=(0,f.A)(ve,[["render",_e],["__scopeId","data-v-1ec55a4f"]]);var ge=fe;const ye={class:"pros-block__icon-wrapper"},Ce={class:"pros-block__content"},xe={key:1,class:"pros-block__edit"},Ie={class:"pros-block__icon-wrapper"};function Le(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["pros-block",{"pros-block--editing":n.editing}])},[n.editing?((0,i.uX)(),(0,i.CE)("div",xe,[(0,i.Lk)("div",Ie,[(0,i.bF)(a.w,{icon:"mdi-thumb-up",size:"18"})]),(0,i.bo)((0,i.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draft=e),class:"pros-block__textarea",placeholder:"Введите преимущество...",rows:"2",onBlur:t[3]||(t[3]=(...e)=>d.save&&d.save(...e)),onKeydown:t[4]||(t[4]=(0,s.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))},null,544),[[s.Jo,n.draft]])])):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"pros-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,i.Lk)("div",ye,[(0,i.bF)(a.w,{icon:"mdi-thumb-up",size:"18"})]),(0,i.Lk)("p",Ce,(0,o.v_)(l.block.textContent||"Нажмите для редактирования..."),1),(0,i.Lk)("button",{class:"pros-block__delete",onClick:t[0]||(t[0]=(0,s.D$)(t=>e.$emit("delete"),["stop"]))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]))],2)}var we={name:"ProsBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draft:""}},methods:{startEdit(){this.draft=this.block.textContent||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draft!==this.block.textContent){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"PROS",textContent:this.draft}),this.$emit("update",{...this.block,textContent:this.draft})}catch(e){console.error("Failed to update block:",e)}this.editing=!1}else this.editing=!1},cancel(){this.editing=!1}}};const Ee=(0,f.A)(we,[["render",Le],["__scopeId","data-v-67ff86f3"]]);var Te=Ee;const Be={class:"cons-block__icon-wrapper"},De={class:"cons-block__content"},Fe={key:1,class:"cons-block__edit"},Se={class:"cons-block__icon-wrapper"};function Xe(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["cons-block",{"cons-block--editing":n.editing}])},[n.editing?((0,i.uX)(),(0,i.CE)("div",Fe,[(0,i.Lk)("div",Se,[(0,i.bF)(a.w,{icon:"mdi-thumb-down",size:"18"})]),(0,i.bo)((0,i.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draft=e),class:"cons-block__textarea",placeholder:"Введите недостаток...",rows:"2",onBlur:t[3]||(t[3]=(...e)=>d.save&&d.save(...e)),onKeydown:t[4]||(t[4]=(0,s.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))},null,544),[[s.Jo,n.draft]])])):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"cons-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,i.Lk)("div",Be,[(0,i.bF)(a.w,{icon:"mdi-thumb-down",size:"18"})]),(0,i.Lk)("p",De,(0,o.v_)(l.block.textContent||"Нажмите для редактирования..."),1),(0,i.Lk)("button",{class:"cons-block__delete",onClick:t[0]||(t[0]=(0,s.D$)(t=>e.$emit("delete"),["stop"]))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]))],2)}var $e={name:"ConsBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draft:""}},methods:{startEdit(){this.draft=this.block.textContent||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draft!==this.block.textContent){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"CONS",textContent:this.draft}),this.$emit("update",{...this.block,textContent:this.draft})}catch(e){console.error("Failed to update block:",e)}this.editing=!1}else this.editing=!1},cancel(){this.editing=!1}}};const Ue=(0,f.A)($e,[["render",Xe],["__scopeId","data-v-7f7eaffb"]]);var Ae=Ue;const ze={key:0,class:"link-block__view"},qe={class:"link-block__text"},Ke={key:0,class:"link-block__url"},Re={key:1,class:"link-block__edit"};function Pe(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["link-block",{"link-block--editing":n.editing}])},[n.editing?((0,i.uX)(),(0,i.CE)("div",Re,[(0,i.bo)((0,i.Lk)("input",{ref:"urlInput","onUpdate:modelValue":t[3]||(t[3]=e=>n.draftUrl=e),type:"url",class:"link-block__input",placeholder:"https://example.com",onKeyup:t[4]||(t[4]=(0,s.jR)(t=>e.$refs.textInput?.focus(),["enter"]))},null,544),[[s.Jo,n.draftUrl]]),(0,i.bo)((0,i.Lk)("input",{ref:"textInput","onUpdate:modelValue":t[5]||(t[5]=e=>n.draftText=e),type:"text",class:"link-block__input",placeholder:"Текст ссылки",onKeyup:t[6]||(t[6]=(0,s.jR)((...e)=>d.save&&d.save(...e),["enter"])),onBlur:t[7]||(t[7]=(...e)=>d.save&&d.save(...e))},null,544),[[s.Jo,n.draftText]]),(0,i.Lk)("button",{class:"link-block__cancel",onClick:t[8]||(t[8]=(...e)=>d.cancel&&d.cancel(...e))},[(0,i.bF)(a.w,{icon:"mdi-close",size:"18"})])])):((0,i.uX)(),(0,i.CE)("div",ze,[(0,i.Lk)("div",{class:"link-block__icon-wrapper",onClick:t[0]||(t[0]=(...e)=>d.openLink&&d.openLink(...e))},[(0,i.bF)(a.w,{icon:"mdi-link-variant",size:"20"})]),(0,i.Lk)("div",{class:"link-block__content",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,i.Lk)("span",qe,(0,o.v_)(l.block.text||l.block.url||"Добавить ссылку"),1),l.block.url?((0,i.uX)(),(0,i.CE)("span",Ke,(0,o.v_)(d.displayUrl),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{class:"link-block__delete",onClick:t[2]||(t[2]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]))],2)}l(4603),l(7566),l(8721);var Ve={name:"LinkBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draftUrl:"",draftText:""}},computed:{displayUrl(){if(!this.block.url)return"";try{const e=new URL(this.block.url);return e.hostname}catch{return this.block.url}}},methods:{startEdit(){this.draftUrl=this.block.url||"",this.draftText=this.block.text||"",this.editing=!0,this.$nextTick(()=>{this.$refs.urlInput?.focus()})},openLink(){this.block.url?window.open(this.block.url,"_blank"):this.startEdit()},async save(){if(this.draftUrl!==this.block.url||this.draftText!==this.block.text){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"LINK",url:this.draftUrl,text:this.draftText}),this.$emit("update",{...this.block,url:this.draftUrl,text:this.draftText})}catch(e){console.error("Failed to update link:",e)}this.editing=!1}else this.editing=!1},cancel(){this.editing=!1}}};const Oe=(0,f.A)(Ve,[["render",Pe],["__scopeId","data-v-405f2150"]]);var je=Oe;const Qe={class:"status-block"},He={class:"status-block__header"},Ne={class:"status-block__options"},Je=["onClick"];function We(e,t,l,s,c,n){return(0,i.uX)(),(0,i.CE)("div",Qe,[(0,i.Lk)("div",He,[(0,i.bF)(a.w,{icon:"mdi-flag-outline",size:"18",class:"status-block__icon"}),t[1]||(t[1]=(0,i.Lk)("span",{class:"status-block__label"},"Статус",-1)),(0,i.Lk)("button",{class:"status-block__delete",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]),(0,i.Lk)("div",Ne,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.statusOptions,e=>((0,i.uX)(),(0,i.CE)("button",{key:e.value,class:(0,o.C4)(["status-block__option",{"status-block__option--active":l.block.status===e.value,["status-block__option--"+e.value.toLowerCase()]:!0}]),onClick:t=>n.setStatus(e.value)},[(0,i.bF)(a.w,{icon:e.icon,size:"18"},null,8,["icon"]),(0,i.Lk)("span",null,(0,o.v_)(e.label),1)],10,Je))),128))])])}var Me={name:"StatusBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{statusOptions:[{value:"IDEA",label:"Идея",icon:"mdi-lightbulb-outline"},{value:"IN_PROGRESS",label:"В процессе",icon:"mdi-progress-clock"},{value:"DONE",label:"Готово",icon:"mdi-check-circle-outline"},{value:"DROPPED",label:"Отменено",icon:"mdi-close-circle-outline"}]}},methods:{async setStatus(e){if(e!==this.block.status)try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"STATUS",status:e}),this.$emit("update",{...this.block,status:e})}catch(t){console.error("Failed to update status:",t)}}}};const Ge=(0,f.A)(Me,[["render",We],["__scopeId","data-v-772ede7e"]]);var Ye=Ge;const Ze={class:"quote-block__content"},et={class:"quote-block__text"},tt={key:0,class:"quote-block__author"},lt={key:1,class:"quote-block__edit"};function it(e,t,l,c,n,d){return(0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["quote-block",{"quote-block--editing":n.editing}])},[n.editing?((0,i.uX)(),(0,i.CE)("div",lt,[(0,i.bo)((0,i.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draftText=e),class:"quote-block__textarea",placeholder:"Текст цитаты...",rows:"3"},null,512),[[s.Jo,n.draftText]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.draftAuthor=e),type:"text",class:"quote-block__input",placeholder:"Автор цитаты",onBlur:t[4]||(t[4]=(...e)=>d.save&&d.save(...e)),onKeyup:t[5]||(t[5]=(0,s.jR)((...e)=>d.save&&d.save(...e),["enter"]))},null,544),[[s.Jo,n.draftAuthor]]),(0,i.Lk)("button",{class:"quote-block__cancel",onClick:t[6]||(t[6]=(...e)=>d.cancel&&d.cancel(...e))},[(0,i.bF)(a.w,{icon:"mdi-close",size:"18"})])])):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"quote-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,i.Lk)("div",Ze,[(0,i.bF)(a.w,{icon:"mdi-format-quote-open",size:"24",class:"quote-block__quote-icon"}),(0,i.Lk)("p",et,(0,o.v_)(l.block.text||"Нажмите для добавления цитаты..."),1),l.block.author?((0,i.uX)(),(0,i.CE)("span",tt,"— "+(0,o.v_)(l.block.author),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{class:"quote-block__delete",onClick:t[0]||(t[0]=(0,s.D$)(t=>e.$emit("delete"),["stop"]))},[(0,i.bF)(a.w,{icon:"mdi-delete-outline",size:"18"})])]))],2)}var st={name:"QuoteBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draftText:"",draftAuthor:""}},methods:{startEdit(){this.draftText=this.block.text||"",this.draftAuthor=this.block.author||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draftText!==this.block.text||this.draftAuthor!==this.block.author){try{await _.xt.updateBlock(this.pageId,this.block.id,{type:"QUOTE",text:this.draftText,author:this.draftAuthor}),this.$emit("update",{...this.block,text:this.draftText,author:this.draftAuthor})}catch(e){console.error("Failed to update quote:",e)}this.editing=!1}else this.editing=!1},cancel(){this.editing=!1}}};const ot=(0,f.A)(st,[["render",it],["__scopeId","data-v-6c5e6a69"]]);var at=ot;const ct={TEXT:y,HEADING:T,DIVIDER:X,CHECKLIST:O,BULLET_LIST:Y,KEY_VALUE:ne,IDEA_CARD:ge,PROS:Te,CONS:Ae,LINK:je,STATUS:Ye,QUOTE:at};var nt={name:"BlockRenderer",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],computed:{blockComponent(){const e=this.block.type||this.block.blockType;return ct[e]||y}}};const dt=(0,f.A)(nt,[["render",p]]);var rt=dt;const ut={key:0,class:"block-menu"},kt={class:"block-menu__search"},pt={class:"block-menu__list"},bt={key:0,class:"block-menu__empty"},ht={key:1,class:"block-menu__section"},mt=["onClick","onMouseenter"],_t={class:"block-menu__item-icon"},vt={class:"block-menu__item-info"},ft={class:"block-menu__item-name"},gt={class:"block-menu__item-desc"},yt={key:2,class:"block-menu__section"},Ct={class:"block-menu__section-title"},xt={key:0,class:"block-menu__pro-badge"},It=["onClick","onMouseenter"],Lt={class:"block-menu__item-info"},wt={class:"block-menu__item-name"},Et={class:"block-menu__item-desc"};function Tt(e,t,l,c,n,d){return(0,i.uX)(),(0,i.Wv)(i.Im,{to:"body"},[(0,i.bF)(s.eB,{name:"fade"},{default:(0,i.k6)(()=>[l.show?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"block-menu__overlay",onClick:t[6]||(t[6]=(0,s.D$)(t=>e.$emit("close"),["self"]))},[(0,i.bF)(s.eB,{name:"scale"},{default:(0,i.k6)(()=>[l.show?((0,i.uX)(),(0,i.CE)("div",ut,[(0,i.Lk)("div",kt,[(0,i.bF)(a.w,{icon:"mdi-magnify",size:"18",class:"block-menu__search-icon"}),(0,i.bo)((0,i.Lk)("input",{ref:"searchInput","onUpdate:modelValue":t[0]||(t[0]=e=>n.search=e),type:"text",class:"block-menu__search-input",placeholder:"Поиск блоков...",onKeydown:[t[1]||(t[1]=(0,s.jR)((0,s.D$)((...e)=>d.navigateDown&&d.navigateDown(...e),["prevent"]),["down"])),t[2]||(t[2]=(0,s.jR)((0,s.D$)((...e)=>d.navigateUp&&d.navigateUp(...e),["prevent"]),["up"])),t[3]||(t[3]=(0,s.jR)((0,s.D$)((...e)=>d.selectCurrent&&d.selectCurrent(...e),["prevent"]),["enter"])),t[4]||(t[4]=(0,s.jR)(t=>e.$emit("close"),["escape"]))]},null,544),[[s.Jo,n.search]])]),(0,i.Lk)("div",pt,[0===d.filteredBlocks.length?((0,i.uX)(),(0,i.CE)("div",bt," Ничего не найдено ")):(0,i.Q3)("",!0),d.filteredFreeBlocks.length>0?((0,i.uX)(),(0,i.CE)("div",ht,[t[7]||(t[7]=(0,i.Lk)("div",{class:"block-menu__section-title"},"Основные",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(d.filteredFreeBlocks,(e,t)=>((0,i.uX)(),(0,i.CE)("button",{key:e.blockType,class:(0,o.C4)(["block-menu__item",{"block-menu__item--active":n.selectedIndex===t}]),onClick:t=>d.select(e),onMouseenter:e=>n.selectedIndex=t},[(0,i.Lk)("div",_t,[(0,i.bF)(a.w,{icon:d.getIcon(e.blockType),size:"20"},null,8,["icon"])]),(0,i.Lk)("div",vt,[(0,i.Lk)("span",ft,(0,o.v_)(e.blockName),1),(0,i.Lk)("span",gt,(0,o.v_)(d.getDescription(e.blockType)),1)])],42,mt))),128))])):(0,i.Q3)("",!0),d.filteredPremiumBlocks.length>0?((0,i.uX)(),(0,i.CE)("div",yt,[(0,i.Lk)("div",Ct,[t[8]||(t[8]=(0,i.eW)(" Премиум ",-1)),l.isPremium?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("span",xt,"PRO"))]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(d.filteredPremiumBlocks,(e,t)=>((0,i.uX)(),(0,i.CE)("button",{key:e.blockType,class:(0,o.C4)(["block-menu__item",{"block-menu__item--active":n.selectedIndex===d.filteredFreeBlocks.length+t,"block-menu__item--locked":!l.isPremium}]),onClick:t=>d.select(e),onMouseenter:e=>n.selectedIndex=d.filteredFreeBlocks.length+t},[(0,i.Lk)("div",{class:(0,o.C4)(["block-menu__item-icon",{"block-menu__item-icon--premium":!l.isPremium}])},[(0,i.bF)(a.w,{icon:d.getIcon(e.blockType),size:"20"},null,8,["icon"])],2),(0,i.Lk)("div",Lt,[(0,i.Lk)("span",wt,(0,o.v_)(e.blockName),1),(0,i.Lk)("span",Et,(0,o.v_)(d.getDescription(e.blockType)),1)]),l.isPremium?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(a.w,{key:0,icon:"mdi-lock",size:"14",class:"block-menu__item-lock"}))],42,It))),128))])):(0,i.Q3)("",!0)]),!l.isPremium&&d.filteredPremiumBlocks.length>0?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"block-menu__upgrade",onClick:t[5]||(t[5]=(...e)=>d.goToPlans&&d.goToPlans(...e))},[(0,i.bF)(a.w,{icon:"mdi-crown",size:"16"}),t[9]||(t[9]=(0,i.Lk)("span",null,"Разблокировать все блоки",-1)),(0,i.bF)(a.w,{icon:"mdi-arrow-right",size:"16"})])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)]),_:1})])):(0,i.Q3)("",!0)]),_:1})])}const Bt={TEXT:"mdi-text",HEADING:"mdi-format-header-1",DIVIDER:"mdi-minus",CHECKLIST:"mdi-checkbox-marked-outline",BULLET_LIST:"mdi-format-list-bulleted",KEY_VALUE:"mdi-table-row",IDEA_CARD:"mdi-lightbulb-outline",PROS:"mdi-thumb-up-outline",CONS:"mdi-thumb-down-outline",LINK:"mdi-link-variant",STATUS:"mdi-flag-outline",QUOTE:"mdi-format-quote-close"},Dt={TEXT:"Простой текстовый блок",HEADING:"Заголовок H1, H2, H3",DIVIDER:"Горизонтальный разделитель",CHECKLIST:"Список задач с галочками",BULLET_LIST:"Маркированный список",KEY_VALUE:"Пары ключ-значение",IDEA_CARD:"Структурированная идея",PROS:"Преимущество / плюс",CONS:"Недостаток / минус",LINK:"Ссылка на ресурс",STATUS:"Статус задачи",QUOTE:"Цитата с автором"};var Ft={name:"BlockTypeSelector",props:{show:{type:Boolean,default:!1},blockTypes:{type:Array,default:()=>[]},isPremium:{type:Boolean,default:!1}},emits:["close","select"],data(){return{search:"",selectedIndex:0}},computed:{filteredBlocks(){if(!this.search.trim())return this.blockTypes;const e=this.search.toLowerCase();return this.blockTypes.filter(t=>t.blockName.toLowerCase().includes(e)||this.getDescription(t.blockType).toLowerCase().includes(e))},filteredFreeBlocks(){return this.filteredBlocks.filter(e=>e.isFreeBlock)},filteredPremiumBlocks(){return this.filteredBlocks.filter(e=>!e.isFreeBlock)}},watch:{show(e){e&&(this.search="",this.selectedIndex=0,this.$nextTick(()=>{this.$refs.searchInput?.focus()}))},search(){this.selectedIndex=0}},methods:{getIcon(e){return Bt[e]||"mdi-card-outline"},getDescription(e){return Dt[e]||""},select(e){e.isFreeBlock||this.isPremium?this.$emit("select",e.blockType):this.goToPlans()},navigateDown(){const e=this.filteredBlocks.length;e>0&&(this.selectedIndex=(this.selectedIndex+1)%e)},navigateUp(){const e=this.filteredBlocks.length;e>0&&(this.selectedIndex=(this.selectedIndex-1+e)%e)},selectCurrent(){const e=this.filteredBlocks[this.selectedIndex];e&&this.select(e)},goToPlans(){this.$emit("close"),this.$router.push({name:"subscription-plans"})}}};const St=(0,f.A)(Ft,[["render",Tt],["__scopeId","data-v-eeb05008"]]);var Xt=St,$t=l(6844);const Ut={key:0,class:"confirm-dialog"},At={class:"confirm-dialog__title"},zt={key:0,class:"confirm-dialog__message"},qt={class:"confirm-dialog__actions"};function Kt(e,t,l,a,c,n){return(0,i.uX)(),(0,i.Wv)(i.Im,{to:"body"},[(0,i.bF)(s.eB,{name:"fade"},{default:(0,i.k6)(()=>[l.show?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"confirm-dialog__overlay",onClick:t[2]||(t[2]=(0,s.D$)(t=>e.$emit("cancel"),["self"]))},[(0,i.bF)(s.eB,{name:"slide-up"},{default:(0,i.k6)(()=>[l.show?((0,i.uX)(),(0,i.CE)("div",Ut,[(0,i.Lk)("h3",At,(0,o.v_)(l.title),1),l.message?((0,i.uX)(),(0,i.CE)("p",zt,(0,o.v_)(l.message),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",qt,[(0,i.Lk)("button",{class:"confirm-dialog__btn confirm-dialog__btn--cancel",onClick:t[0]||(t[0]=t=>e.$emit("cancel"))},(0,o.v_)(l.cancelText),1),(0,i.Lk)("button",{class:(0,o.C4)(["confirm-dialog__btn",{"confirm-dialog__btn--danger":l.danger}]),onClick:t[1]||(t[1]=t=>e.$emit("confirm"))},(0,o.v_)(l.confirmText),3)])])):(0,i.Q3)("",!0)]),_:1})])):(0,i.Q3)("",!0)]),_:1})])}var Rt={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,required:!0},message:{type:String,default:""},confirmText:{type:String,default:"Удалить"},cancelText:{type:String,default:"Отмена"},danger:{type:Boolean,default:!1}},emits:["confirm","cancel"]};const Pt=(0,f.A)(Rt,[["render",Kt],["__scopeId","data-v-49d6e655"]]);var Vt=Pt,Ot={name:"PageDetailView",components:{BlockRenderer:rt,BlockTypeSelector:Xt,EmptyState:$t.A,ConfirmDialog:Vt},data(){return{loading:!0,page:null,editingTitle:!1,titleDraft:"",showBlockSelector:!1,showDeleteConfirm:!1,showBlockDeleteConfirm:!1,blockToDelete:null,blockIndexToDelete:null,blockTypes:[],isPremium:!1}},computed:{pageId(){return this.$route.params.id}},async mounted(){await this.loadData()},methods:{async loadData(){try{this.loading=!0;const[e,t,l]=await Promise.all([_.v0.getPage(this.pageId),_.v0.getBlockTypes(),_.eS.getCurrent()]);this.page=e.data,console.log("Block types response:",t.data),this.blockTypes=t.data.blocks||[],console.log("Loaded blockTypes:",this.blockTypes),this.isPremium="PREMIUM"===l.data.plan}catch(e){console.error("Failed to load page:",e),this.$router.replace({name:"pages"})}finally{this.loading=!1}},goBack(){this.$router.push({name:"pages"})},startTitleEdit(){this.titleDraft=this.page?.title||"",this.editingTitle=!0,this.$nextTick(()=>{this.$refs.titleInput?.focus(),this.$refs.titleInput?.select()})},async saveTitle(){if(this.titleDraft.trim()||(this.titleDraft=this.page?.title||""),this.titleDraft!==this.page?.title){try{await _.v0.updatePage(this.pageId,{title:this.titleDraft.trim()}),this.page.title=this.titleDraft.trim()}catch(e){console.error("Failed to update title:",e)}this.editingTitle=!1}else this.editingTitle=!1},cancelTitleEdit(){this.editingTitle=!1},async createBlock(e){this.showBlockSelector=!1;const t=this.getDefaultBlockPayload(e);console.log("Creating block with payload:",t);try{const e=await _.xt.createBlock(this.pageId,t);console.log("Block created, response:",e.data),this.page.blocks.push(e.data)}catch(l){console.error("Failed to create block:",l)}},getDefaultBlockPayload(e){switch(e){case"TEXT":case"PROS":case"CONS":return{type:e,textContent:""};case"HEADING":return{type:e,header:"",level:1};case"DIVIDER":return{type:e};case"CHECKLIST":return{type:e,items:[{text:"",status:!1}]};case"BULLET_LIST":return{type:e,items:[""]};case"KEY_VALUE":return{type:e,items:[{key:"",value:""}]};case"IDEA_CARD":return{type:e,problem:"",solution:"",audience:"",mvp:"",monetization:""};case"LINK":return{type:e,url:"",text:""};case"STATUS":return{type:e,status:"IDEA"};case"QUOTE":return{type:e,text:"",author:""};default:return{type:e}}},updateBlock(e,t){this.page.blocks[e]=t},deleteBlock(e,t){this.blockToDelete=e,this.blockIndexToDelete=t,this.showBlockDeleteConfirm=!0},async confirmDeleteBlock(){if(this.blockToDelete){try{await _.xt.deleteBlock(this.pageId,this.blockToDelete.id),this.page.blocks.splice(this.blockIndexToDelete,1)}catch(e){console.error("Failed to delete block:",e)}this.blockToDelete=null,this.blockIndexToDelete=null,this.showBlockDeleteConfirm=!1}},cancelDeleteBlock(){this.blockToDelete=null,this.blockIndexToDelete=null,this.showBlockDeleteConfirm=!1},async deletePage(){try{await _.v0.deletePage(this.pageId),this.$router.replace({name:"pages"})}catch(e){console.error("Failed to delete page:",e)}this.showDeleteConfirm=!1}}};const jt=(0,f.A)(Ot,[["render",k],["__scopeId","data-v-71ba6b54"]]);var Qt=jt},6844:function(e,t,l){l.d(t,{A:function(){return b}});var i=l(6768),s=l(4232),o=l(365);const a={class:"empty-state"},c={class:"empty-state__icon-wrapper"},n={class:"empty-state__title"},d={key:0,class:"empty-state__subtitle"};function r(e,t,l,r,u,k){return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("div",c,[(0,i.bF)(o.w,{icon:l.icon,size:"48",class:"empty-state__icon"},null,8,["icon"])]),(0,i.Lk)("h3",n,(0,s.v_)(l.title),1),l.subtitle?((0,i.uX)(),(0,i.CE)("p",d,(0,s.v_)(l.subtitle),1)):(0,i.Q3)("",!0),l.actionText?((0,i.uX)(),(0,i.CE)("button",{key:1,class:"empty-state__action",onClick:t[0]||(t[0]=t=>e.$emit("action"))},(0,s.v_)(l.actionText),1)):(0,i.Q3)("",!0)])}var u={name:"EmptyState",props:{icon:{type:String,default:"mdi-note-outline"},title:{type:String,required:!0},subtitle:{type:String,default:""},actionText:{type:String,default:""}},emits:["action"]},k=l(1241);const p=(0,k.A)(u,[["render",r],["__scopeId","data-v-5b7a5deb"]]);var b=p}}]);
//# sourceMappingURL=page-detail.d15a1bf7.js.map