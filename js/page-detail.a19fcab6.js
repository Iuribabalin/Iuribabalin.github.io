"use strict";(self["webpackChunkmini_notes_ui"]=self["webpackChunkmini_notes_ui"]||[]).push([[168],{5095:function(e,t,i){i.r(t),i.d(t,{default:function(){return Yt}});var l=i(6768),o=i(5130),s=i(4232),c=i(365);const a={class:"page-detail"},n={class:"page-detail__header"},d={class:"page-detail__title-wrapper"},r={class:"page-detail__content"},k={key:0,class:"page-detail__loading"};function u(e,t,i,u,b,p){const h=(0,l.g2)("EmptyState"),m=(0,l.g2)("BlockRenderer"),_=(0,l.g2)("BlockTypeSelector"),v=(0,l.g2)("ConfirmDialog");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.Lk)("div",n,[(0,l.Lk)("button",{class:"page-detail__back",onClick:t[0]||(t[0]=(...e)=>p.goBack&&p.goBack(...e))},[(0,l.bF)(c.w,{icon:"mdi-arrow-left",size:"24"})]),(0,l.Lk)("div",d,[b.editingTitle?(0,l.bo)(((0,l.uX)(),(0,l.CE)("input",{key:0,ref:"titleInput","onUpdate:modelValue":t[1]||(t[1]=e=>b.titleDraft=e),type:"text",class:"page-detail__title-input",maxlength:"200",onBlur:t[2]||(t[2]=(...e)=>p.saveTitle&&p.saveTitle(...e)),onKeyup:[t[3]||(t[3]=(0,o.jR)((...e)=>p.saveTitle&&p.saveTitle(...e),["enter"])),t[4]||(t[4]=(0,o.jR)((...e)=>p.cancelTitleEdit&&p.cancelTitleEdit(...e),["escape"]))]},null,544)),[[o.Jo,b.titleDraft]]):((0,l.uX)(),(0,l.CE)("h1",{key:1,class:"page-detail__title",onClick:t[5]||(t[5]=(...e)=>p.startTitleEdit&&p.startTitleEdit(...e))},(0,s.v_)(b.page?.title||"Загрузка..."),1))]),(0,l.Lk)("button",{class:"page-detail__delete",onClick:t[6]||(t[6]=e=>b.showDeleteConfirm=!0)},[(0,l.bF)(c.w,{icon:"mdi-delete-outline",size:"22"})])]),(0,l.Lk)("div",r,[b.loading?((0,l.uX)(),(0,l.CE)("div",k,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(3,e=>(0,l.Lk)("div",{class:"page-detail__loading-block",key:e})),64))])):b.page?.blocks?.length?((0,l.uX)(),(0,l.Wv)(o.F,{key:2,name:"fade-up",tag:"div",class:"page-detail__blocks"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.page.blocks,(e,t)=>((0,l.uX)(),(0,l.Wv)(m,{key:e.id,block:e,"page-id":p.pageId,style:(0,s.Tr)({transitionDelay:.03*t+"s"}),onUpdate:e=>p.updateBlock(t,e),onDelete:i=>p.deleteBlock(e,t)},null,8,["block","page-id","style","onUpdate","onDelete"]))),128))]),_:1})):((0,l.uX)(),(0,l.Wv)(h,{key:1,icon:"mdi-text-box-plus-outline",title:"Нет блоков",subtitle:"Добавьте первый блок в заметку","action-text":"Добавить блок",onAction:t[7]||(t[7]=e=>b.showBlockSelector=!0)}))]),(0,l.Lk)("button",{class:"page-detail__fab",onClick:t[8]||(t[8]=e=>b.showBlockSelector=!0)},[(0,l.bF)(c.w,{icon:"mdi-plus",size:"28"})]),(0,l.bF)(_,{show:b.showBlockSelector,"block-types":b.blockTypes,"is-premium":b.isPremium,onClose:t[9]||(t[9]=e=>b.showBlockSelector=!1),onSelect:p.createBlock},null,8,["show","block-types","is-premium","onSelect"]),(0,l.bF)(v,{show:b.showDeleteConfirm,title:"Удалить страницу?",message:"Страница и все её блоки будут удалены безвозвратно.","confirm-text":"Удалить",danger:!0,onConfirm:p.deletePage,onCancel:t[10]||(t[10]=e=>b.showDeleteConfirm=!1)},null,8,["show","onConfirm"]),(0,l.bF)(v,{show:b.showBlockDeleteConfirm,title:"Удалить блок?",message:"Блок будет удален безвозвратно.","confirm-text":"Удалить",danger:!0,onConfirm:p.confirmDeleteBlock,onCancel:p.cancelDeleteBlock},null,8,["show","onConfirm","onCancel"])])}i(4114);function b(e,t,i,o,s,c){return(0,l.uX)(),(0,l.Wv)((0,l.$y)(c.blockComponent),{block:i.block,"page-id":i.pageId,onUpdate:t[0]||(t[0]=t=>e.$emit("update",t)),onDelete:t[1]||(t[1]=t=>e.$emit("delete"))},null,40,["block","page-id"])}const p={class:"text-block__content"},h={key:1,class:"text-block__edit"},m={class:"text-block__actions"};function _(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["text-block",{"text-block--editing":n.editing}])},[n.editing?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.bo)((0,l.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draft=e),class:"text-block__textarea",placeholder:"Введите текст...",rows:"3",onKeydown:t[3]||(t[3]=(0,o.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))},null,544),[[o.Jo,n.draft]]),(0,l.Lk)("div",m,[(0,l.Lk)("button",{class:"text-block__done",onClick:t[4]||(t[4]=(...e)=>d.save&&d.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[5]||(t[5]=(0,l.eW)(" Готово ",-1))])])])):((0,l.uX)(),(0,l.CE)("div",{key:0,class:"text-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,l.Lk)("p",p,(0,s.v_)(i.block.content||"Нажмите для редактирования..."),1),(0,l.Lk)("button",{class:"text-block__menu",onClick:t[0]||(t[0]=(0,o.D$)(t=>e.$emit("delete"),["stop"]))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]))],2)}var v=i(1668),f={name:"TextBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draft:""}},methods:{startEdit(){this.draft=this.block.content||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draft===this.block.content)return void(this.editing=!1);const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"TEXT",textContent:this.draft}),this.$emit("update",{...this.block,content:this.draft})}catch(i){console.error("Failed to update block:",i)}this.editing=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancel(){this.editing=!1}}},g=i(1241);const y=(0,g.A)(f,[["render",_],["__scopeId","data-v-c7328e84"]]);var w=y;const C={key:1,class:"heading-block__edit"},L={class:"heading-block__levels"},x=["onClick"],I={class:"heading-block__actions"};function T(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["heading-block",{"heading-block--editing":n.editing}])},[n.editing?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.Lk)("div",L,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(3,e=>(0,l.Lk)("button",{key:e,class:(0,s.C4)(["heading-block__level",{"heading-block__level--active":n.draftLevel===e}]),onClick:t=>n.draftLevel=e}," H"+(0,s.v_)(e),11,x)),64))]),(0,l.bo)((0,l.Lk)("input",{ref:"input","onUpdate:modelValue":t[2]||(t[2]=e=>n.draftHeader=e),type:"text",class:(0,s.C4)(["heading-block__input","heading-block__input--h"+n.draftLevel]),placeholder:"Введите заголовок...",onKeyup:[t[3]||(t[3]=(0,o.jR)((...e)=>d.save&&d.save(...e),["enter"])),t[4]||(t[4]=(0,o.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))]},null,34),[[o.Jo,n.draftHeader]]),(0,l.Lk)("div",I,[(0,l.Lk)("button",{class:"heading-block__done",onClick:t[5]||(t[5]=(...e)=>d.save&&d.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[6]||(t[6]=(0,l.eW)(" Готово ",-1))])])])):((0,l.uX)(),(0,l.CE)("div",{key:0,class:"heading-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[((0,l.uX)(),(0,l.Wv)((0,l.$y)("h"+i.block.level),{class:(0,s.C4)(["heading-block__text","heading-block__text--h"+i.block.level])},{default:(0,l.k6)(()=>[(0,l.eW)((0,s.v_)(i.block.header||"Заголовок"),1)]),_:1},8,["class"])),(0,l.Lk)("button",{class:"heading-block__menu",onClick:t[0]||(t[0]=(0,o.D$)(t=>e.$emit("delete"),["stop"]))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]))],2)}var E={name:"HeadingBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draftHeader:"",draftLevel:1}},methods:{startEdit(){this.draftHeader=this.block.header||"",this.draftLevel=this.block.level||1,this.editing=!0,this.$nextTick(()=>{this.$refs.input?.focus()})},async save(){if(this.draftHeader===this.block.header&&this.draftLevel===this.block.level)return void(this.editing=!1);const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"HEADING",header:this.draftHeader,level:this.draftLevel}),this.$emit("update",{...this.block,header:this.draftHeader,level:this.draftLevel})}catch(i){console.error("Failed to update heading:",i)}this.editing=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancel(){this.editing=!1}}};const B=(0,g.A)(E,[["render",T],["__scopeId","data-v-73836854"]]);var F=B;const D={class:"divider-block"};function X(e,t,i,o,s,a){return(0,l.uX)(),(0,l.CE)("div",D,[t[1]||(t[1]=(0,l.Lk)("div",{class:"divider-block__line"},null,-1)),(0,l.Lk)("button",{class:"divider-block__menu",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"16"})])])}var $={name:"DividerBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"]};const S=(0,g.A)($,[["render",X],["__scopeId","data-v-234677ad"]]);var z=S;const U={class:"checklist-block"},A={class:"checklist-block__header"},q={class:"checklist-block__items"},K=["onClick"],P=["onUpdate:modelValue","onKeyup"],R=["onClick"];function V(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",U,[(0,l.Lk)("div",A,[(0,l.bF)(c.w,{icon:"mdi-checkbox-marked-outline",size:"18",class:"checklist-block__icon"}),t[3]||(t[3]=(0,l.Lk)("span",{class:"checklist-block__label"},"Чек-лист",-1)),(0,l.Lk)("button",{class:"checklist-block__menu",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]),(0,l.Lk)("div",q,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.items,(e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t,class:"checklist-block__item"},[(0,l.Lk)("button",{class:(0,s.C4)(["checklist-block__checkbox",{"checklist-block__checkbox--checked":e.status}]),onClick:e=>d.toggleItem(t)},[(0,l.bF)(c.w,{icon:e.status?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",size:"22"},null,8,["icon"])],10,K),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t=>e.text=t,type:"text",class:(0,s.C4)(["checklist-block__input",{"checklist-block__input--done":e.status}]),placeholder:"Новый пункт...",onKeyup:(0,o.jR)(e=>d.addItem(t+1),["enter"])},null,42,P),[[o.Jo,e.text]]),n.items.length>1?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"checklist-block__remove",onClick:e=>d.removeItem(t)},[(0,l.bF)(c.w,{icon:"mdi-close",size:"16"})],8,R)):(0,l.Q3)("",!0)]))),128))]),(0,l.Lk)("button",{class:"checklist-block__add",onClick:t[1]||(t[1]=e=>d.addItem())},[(0,l.bF)(c.w,{icon:"mdi-plus",size:"18"}),t[4]||(t[4]=(0,l.eW)(" Добавить пункт ",-1))]),(0,l.Lk)("button",{class:"checklist-block__done",onClick:t[2]||(t[2]=(...e)=>d.saveItems&&d.saveItems(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[5]||(t[5]=(0,l.eW)(" Готово ",-1))])])}i(8111),i(1701);var O={name:"ChecklistBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{items:[]}},watch:{block:{immediate:!0,handler(e){this.items=e.items?.map(e=>({text:e.text,status:e.checked}))||[{text:"",status:!1}]}}},methods:{async toggleItem(e){this.items[e].status=!this.items[e].status,await this.saveItems()},addItem(e){const t=e??this.items.length;this.items.splice(t,0,{text:"",status:!1}),this.$nextTick(()=>{const e=this.$el.querySelectorAll(".checklist-block__input");e[t]?.focus()})},async removeItem(e){this.items.splice(e,1),0===this.items.length&&this.items.push({text:"",status:!1}),await this.saveItems()},async saveItems(){const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"CHECKLIST",items:this.items.map(e=>({text:e.text,checked:e.status}))}),this.$emit("update",{...this.block,items:this.items.map(e=>({text:e.text,checked:e.status}))})}catch(i){console.error("Failed to update checklist:",i)}this.$nextTick(()=>{window.scrollTo(e,t)})}}};const j=(0,g.A)(O,[["render",V],["__scopeId","data-v-18624062"]]);var Q=j;const H={class:"bullet-block"},W={class:"bullet-block__header"},N={class:"bullet-block__items"},J=["onUpdate:modelValue","onKeyup"],Y=["onClick"];function M(e,t,i,s,a,n){return(0,l.uX)(),(0,l.CE)("div",H,[(0,l.Lk)("div",W,[(0,l.bF)(c.w,{icon:"mdi-format-list-bulleted",size:"18",class:"bullet-block__icon"}),t[3]||(t[3]=(0,l.Lk)("span",{class:"bullet-block__label"},"Список",-1)),(0,l.Lk)("button",{class:"bullet-block__menu",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]),(0,l.Lk)("div",N,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.items,(e,i)=>((0,l.uX)(),(0,l.CE)("div",{key:i,class:"bullet-block__item"},[t[4]||(t[4]=(0,l.Lk)("span",{class:"bullet-block__bullet"},null,-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":e=>a.items[i]=e,type:"text",class:"bullet-block__input",placeholder:"Новый пункт...",onKeyup:(0,o.jR)(e=>n.addItem(i+1),["enter"])},null,40,J),[[o.Jo,a.items[i]]]),a.items.length>1?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"bullet-block__remove",onClick:e=>n.removeItem(i)},[(0,l.bF)(c.w,{icon:"mdi-close",size:"16"})],8,Y)):(0,l.Q3)("",!0)]))),128))]),(0,l.Lk)("button",{class:"bullet-block__add",onClick:t[1]||(t[1]=e=>n.addItem())},[(0,l.bF)(c.w,{icon:"mdi-plus",size:"18"}),t[5]||(t[5]=(0,l.eW)(" Добавить пункт ",-1))]),(0,l.Lk)("button",{class:"bullet-block__done",onClick:t[2]||(t[2]=(...e)=>n.saveItems&&n.saveItems(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[6]||(t[6]=(0,l.eW)(" Готово ",-1))])])}var G={name:"BulletListBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{items:[]}},watch:{block:{immediate:!0,handler(e){this.items=e.items?.length?[...e.items]:[""]}}},methods:{addItem(e){const t=e??this.items.length;this.items.splice(t,0,""),this.$nextTick(()=>{const e=this.$el.querySelectorAll(".bullet-block__input");e[t]?.focus()})},async removeItem(e){this.items.splice(e,1),0===this.items.length&&this.items.push(""),await this.saveItems()},async saveItems(){const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"BULLET_LIST",items:this.items}),this.$emit("update",{...this.block,items:[...this.items]})}catch(i){console.error("Failed to update bullet list:",i)}this.$nextTick(()=>{window.scrollTo(e,t)})}}};const Z=(0,g.A)(G,[["render",M],["__scopeId","data-v-42fe2a76"]]);var ee=Z;const te={class:"kv-block"},ie={class:"kv-block__header"},le={class:"kv-block__items"},oe=["onUpdate:modelValue"],se=["onUpdate:modelValue","onKeyup"],ce=["onClick"];function ae(e,t,i,s,a,n){return(0,l.uX)(),(0,l.CE)("div",te,[(0,l.Lk)("div",ie,[(0,l.bF)(c.w,{icon:"mdi-table-row",size:"18",class:"kv-block__icon"}),t[3]||(t[3]=(0,l.Lk)("span",{class:"kv-block__label"},"Ключ-значение",-1)),(0,l.Lk)("button",{class:"kv-block__menu",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]),(0,l.Lk)("div",le,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.items,(e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t,class:"kv-block__item"},[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,type:"text",class:"kv-block__key",placeholder:"Ключ"},null,8,oe),[[o.Jo,e.key]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t=>e.value=t,type:"text",class:"kv-block__value",placeholder:"Значение",onKeyup:(0,o.jR)(e=>n.addItem(t+1),["enter"])},null,40,se),[[o.Jo,e.value]]),a.items.length>1?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"kv-block__remove",onClick:e=>n.removeItem(t)},[(0,l.bF)(c.w,{icon:"mdi-close",size:"16"})],8,ce)):(0,l.Q3)("",!0)]))),128))]),(0,l.Lk)("button",{class:"kv-block__add",onClick:t[1]||(t[1]=e=>n.addItem())},[(0,l.bF)(c.w,{icon:"mdi-plus",size:"18"}),t[4]||(t[4]=(0,l.eW)(" Добавить пару ",-1))]),(0,l.Lk)("button",{class:"kv-block__done",onClick:t[2]||(t[2]=(...e)=>n.saveItems&&n.saveItems(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[5]||(t[5]=(0,l.eW)(" Готово ",-1))])])}var ne={name:"KeyValueBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{items:[]}},watch:{block:{immediate:!0,handler(e){this.items=e.items?.map(e=>({...e}))||[{key:"",value:""}]}}},methods:{addItem(e){const t=e??this.items.length;this.items.splice(t,0,{key:"",value:""}),this.$nextTick(()=>{const e=this.$el.querySelectorAll(".kv-block__key");e[t]?.focus()})},async removeItem(e){this.items.splice(e,1),0===this.items.length&&this.items.push({key:"",value:""}),await this.saveItems()},async saveItems(){const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"KEY_VALUE",items:this.items.map(e=>({key:e.key,value:e.value}))}),this.$emit("update",{...this.block,items:[...this.items]})}catch(i){console.error("Failed to update key-value:",i)}this.$nextTick(()=>{window.scrollTo(e,t)})}}};const de=(0,g.A)(ne,[["render",ae],["__scopeId","data-v-426dd06e"]]);var re=de;const ke={class:"idea-block"},ue={class:"idea-block__header"},be={class:"idea-block__fields"},pe={class:"idea-block__field"},he={class:"idea-block__field"},me={class:"idea-block__field"},_e={class:"idea-block__field"},ve={class:"idea-block__field"};function fe(e,t,i,s,a,n){return(0,l.uX)(),(0,l.CE)("div",ke,[(0,l.Lk)("div",ue,[(0,l.bF)(c.w,{icon:"mdi-lightbulb-outline",size:"18",class:"idea-block__icon"}),t[7]||(t[7]=(0,l.Lk)("span",{class:"idea-block__label"},"Карточка идеи",-1)),(0,l.Lk)("button",{class:"idea-block__menu",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]),(0,l.Lk)("div",be,[(0,l.Lk)("div",pe,[t[8]||(t[8]=(0,l.Lk)("label",{class:"idea-block__field-label"},"Проблема",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.draft.problem=e),class:"idea-block__textarea",placeholder:"Какую проблему решает?",rows:"2"},null,512),[[o.Jo,a.draft.problem]])]),(0,l.Lk)("div",he,[t[9]||(t[9]=(0,l.Lk)("label",{class:"idea-block__field-label"},"Решение",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.draft.solution=e),class:"idea-block__textarea",placeholder:"Как решить проблему?",rows:"2"},null,512),[[o.Jo,a.draft.solution]])]),(0,l.Lk)("div",me,[t[10]||(t[10]=(0,l.Lk)("label",{class:"idea-block__field-label"},"Аудитория",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.draft.audience=e),type:"text",class:"idea-block__input",placeholder:"Целевая аудитория"},null,512),[[o.Jo,a.draft.audience]])]),(0,l.Lk)("div",_e,[t[11]||(t[11]=(0,l.Lk)("label",{class:"idea-block__field-label"},"MVP",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>a.draft.mvp=e),class:"idea-block__textarea",placeholder:"Минимальный продукт",rows:"2"},null,512),[[o.Jo,a.draft.mvp]])]),(0,l.Lk)("div",ve,[t[12]||(t[12]=(0,l.Lk)("label",{class:"idea-block__field-label"},"Монетизация",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>a.draft.monetization=e),type:"text",class:"idea-block__input",placeholder:"Как заработать?"},null,512),[[o.Jo,a.draft.monetization]])])]),(0,l.Lk)("button",{class:"idea-block__done",onClick:t[6]||(t[6]=(...e)=>n.save&&n.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[13]||(t[13]=(0,l.eW)(" Готово ",-1))])])}var ge={name:"IdeaCardBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{draft:{problem:"",solution:"",audience:"",mvp:"",monetization:""}}},watch:{block:{immediate:!0,handler(e){this.draft={problem:e.problem||"",solution:e.solution||"",audience:e.audience||"",mvp:e.mvp||"",monetization:e.monetization||""}}}},methods:{async save(){const e=this.draft.problem!==this.block.problem||this.draft.solution!==this.block.solution||this.draft.audience!==this.block.audience||this.draft.mvp!==this.block.mvp||this.draft.monetization!==this.block.monetization;if(!e)return;const t=window.scrollX,i=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"IDEA_CARD",...this.draft}),this.$emit("update",{...this.block,...this.draft})}catch(l){console.error("Failed to update idea:",l)}this.$nextTick(()=>{window.scrollTo(t,i)})}}};const ye=(0,g.A)(ge,[["render",fe],["__scopeId","data-v-4a568ff2"]]);var we=ye;const Ce={class:"pros-block__icon-wrapper"},Le={class:"pros-block__content"},xe={key:1,class:"pros-block__edit"},Ie={class:"pros-block__icon-wrapper"},Te={class:"pros-block__edit-content"};function Ee(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["pros-block",{"pros-block--editing":n.editing}])},[n.editing?((0,l.uX)(),(0,l.CE)("div",xe,[(0,l.Lk)("div",Ie,[(0,l.bF)(c.w,{icon:"mdi-thumb-up",size:"18"})]),(0,l.Lk)("div",Te,[(0,l.bo)((0,l.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draft=e),class:"pros-block__textarea",placeholder:"Введите преимущество...",rows:"2",onKeydown:t[3]||(t[3]=(0,o.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))},null,544),[[o.Jo,n.draft]]),(0,l.Lk)("button",{class:"pros-block__done",onClick:t[4]||(t[4]=(...e)=>d.save&&d.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"18"})])])])):((0,l.uX)(),(0,l.CE)("div",{key:0,class:"pros-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,l.Lk)("div",Ce,[(0,l.bF)(c.w,{icon:"mdi-thumb-up",size:"18"})]),(0,l.Lk)("p",Le,(0,s.v_)(i.block.content||"Нажмите для редактирования..."),1),(0,l.Lk)("button",{class:"pros-block__menu",onClick:t[0]||(t[0]=(0,o.D$)(t=>e.$emit("delete"),["stop"]))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]))],2)}var Be={name:"ProsBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draft:""}},methods:{startEdit(){this.draft=this.block.content||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draft===this.block.content)return void(this.editing=!1);const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"PROS",textContent:this.draft}),this.$emit("update",{...this.block,content:this.draft})}catch(i){console.error("Failed to update block:",i)}this.editing=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancel(){this.editing=!1}}};const Fe=(0,g.A)(Be,[["render",Ee],["__scopeId","data-v-23bb5954"]]);var De=Fe;const Xe={class:"cons-block__icon-wrapper"},$e={class:"cons-block__content"},Se={key:1,class:"cons-block__edit"},ze={class:"cons-block__icon-wrapper"},Ue={class:"cons-block__edit-content"};function Ae(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["cons-block",{"cons-block--editing":n.editing}])},[n.editing?((0,l.uX)(),(0,l.CE)("div",Se,[(0,l.Lk)("div",ze,[(0,l.bF)(c.w,{icon:"mdi-thumb-down",size:"18"})]),(0,l.Lk)("div",Ue,[(0,l.bo)((0,l.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draft=e),class:"cons-block__textarea",placeholder:"Введите недостаток...",rows:"2",onKeydown:t[3]||(t[3]=(0,o.jR)((...e)=>d.cancel&&d.cancel(...e),["escape"]))},null,544),[[o.Jo,n.draft]]),(0,l.Lk)("button",{class:"cons-block__done",onClick:t[4]||(t[4]=(...e)=>d.save&&d.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"18"})])])])):((0,l.uX)(),(0,l.CE)("div",{key:0,class:"cons-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,l.Lk)("div",Xe,[(0,l.bF)(c.w,{icon:"mdi-thumb-down",size:"18"})]),(0,l.Lk)("p",$e,(0,s.v_)(i.block.content||"Нажмите для редактирования..."),1),(0,l.Lk)("button",{class:"cons-block__menu",onClick:t[0]||(t[0]=(0,o.D$)(t=>e.$emit("delete"),["stop"]))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]))],2)}var qe={name:"ConsBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draft:""}},methods:{startEdit(){this.draft=this.block.content||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draft===this.block.content)return void(this.editing=!1);const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"CONS",textContent:this.draft}),this.$emit("update",{...this.block,content:this.draft})}catch(i){console.error("Failed to update block:",i)}this.editing=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancel(){this.editing=!1}}};const Ke=(0,g.A)(qe,[["render",Ae],["__scopeId","data-v-210492b8"]]);var Pe=Ke;const Re={key:0,class:"link-block__view"},Ve={class:"link-block__text"},Oe={key:0,class:"link-block__url"},je={key:1,class:"link-block__edit"};function Qe(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["link-block",{"link-block--editing":n.editing}])},[n.editing?((0,l.uX)(),(0,l.CE)("div",je,[(0,l.bo)((0,l.Lk)("input",{ref:"urlInput","onUpdate:modelValue":t[3]||(t[3]=e=>n.draftUrl=e),type:"url",class:"link-block__input",placeholder:"https://example.com",onKeyup:t[4]||(t[4]=(0,o.jR)(t=>e.$refs.textInput?.focus(),["enter"]))},null,544),[[o.Jo,n.draftUrl]]),(0,l.bo)((0,l.Lk)("input",{ref:"textInput","onUpdate:modelValue":t[5]||(t[5]=e=>n.draftText=e),type:"text",class:"link-block__input",placeholder:"Текст ссылки",onKeyup:t[6]||(t[6]=(0,o.jR)((...e)=>d.save&&d.save(...e),["enter"]))},null,544),[[o.Jo,n.draftText]]),(0,l.Lk)("button",{class:"link-block__done",onClick:t[7]||(t[7]=(...e)=>d.save&&d.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[9]||(t[9]=(0,l.eW)(" Готово ",-1))]),(0,l.Lk)("button",{class:"link-block__cancel",onClick:t[8]||(t[8]=(...e)=>d.cancel&&d.cancel(...e))},[(0,l.bF)(c.w,{icon:"mdi-close",size:"18"})])])):((0,l.uX)(),(0,l.CE)("div",Re,[(0,l.Lk)("div",{class:"link-block__icon-wrapper",onClick:t[0]||(t[0]=(...e)=>d.openLink&&d.openLink(...e))},[(0,l.bF)(c.w,{icon:"mdi-link-variant",size:"20"})]),(0,l.Lk)("div",{class:"link-block__content",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,l.Lk)("span",Ve,(0,s.v_)(i.block.text||i.block.url||"Добавить ссылку"),1),i.block.url?((0,l.uX)(),(0,l.CE)("span",Oe,(0,s.v_)(d.displayUrl),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("button",{class:"link-block__menu",onClick:t[2]||(t[2]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]))],2)}i(4603),i(7566),i(8721);var He={name:"LinkBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draftUrl:"",draftText:""}},computed:{displayUrl(){if(!this.block.url)return"";try{const e=new URL(this.block.url);return e.hostname}catch{return this.block.url}}},methods:{startEdit(){this.draftUrl=this.block.url||"",this.draftText=this.block.text||"",this.editing=!0,this.$nextTick(()=>{this.$refs.urlInput?.focus()})},openLink(){this.block.url?window.open(this.block.url,"_blank"):this.startEdit()},async save(){if(this.draftUrl===this.block.url&&this.draftText===this.block.text)return void(this.editing=!1);const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"LINK",url:this.draftUrl,text:this.draftText}),this.$emit("update",{...this.block,url:this.draftUrl,text:this.draftText})}catch(i){console.error("Failed to update link:",i)}this.editing=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancel(){this.editing=!1}}};const We=(0,g.A)(He,[["render",Qe],["__scopeId","data-v-60309766"]]);var Ne=We;const Je={class:"status-block"},Ye={class:"status-block__header"},Me={class:"status-block__options"},Ge=["onClick"];function Ze(e,t,i,o,a,n){return(0,l.uX)(),(0,l.CE)("div",Je,[(0,l.Lk)("div",Ye,[(0,l.bF)(c.w,{icon:"mdi-flag-outline",size:"18",class:"status-block__icon"}),t[1]||(t[1]=(0,l.Lk)("span",{class:"status-block__label"},"Статус",-1)),(0,l.Lk)("button",{class:"status-block__menu",onClick:t[0]||(t[0]=t=>e.$emit("delete"))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]),(0,l.Lk)("div",Me,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.statusOptions,e=>((0,l.uX)(),(0,l.CE)("button",{key:e.value,class:(0,s.C4)(["status-block__option",{"status-block__option--active":i.block.status===e.value,["status-block__option--"+e.value.toLowerCase()]:!0}]),onClick:t=>n.setStatus(e.value)},[(0,l.bF)(c.w,{icon:e.icon,size:"18"},null,8,["icon"]),(0,l.Lk)("span",null,(0,s.v_)(e.label),1)],10,Ge))),128))])])}var et={name:"StatusBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{statusOptions:[{value:"IDEA",label:"Идея",icon:"mdi-lightbulb-outline"},{value:"IN_PROGRESS",label:"В процессе",icon:"mdi-progress-clock"},{value:"DONE",label:"Готово",icon:"mdi-check-circle-outline"},{value:"DROPPED",label:"Отменено",icon:"mdi-close-circle-outline"}]}},methods:{async setStatus(e){if(e!==this.block.status)try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"STATUS",status:e}),this.$emit("update",{...this.block,status:e})}catch(t){console.error("Failed to update status:",t)}}}};const tt=(0,g.A)(et,[["render",Ze],["__scopeId","data-v-aa2c26d2"]]);var it=tt;const lt={class:"quote-block__content"},ot={class:"quote-block__text"},st={key:0,class:"quote-block__author"},ct={key:1,class:"quote-block__edit"},at={class:"quote-block__actions"};function nt(e,t,i,a,n,d){return(0,l.uX)(),(0,l.CE)("div",{class:(0,s.C4)(["quote-block",{"quote-block--editing":n.editing}])},[n.editing?((0,l.uX)(),(0,l.CE)("div",ct,[(0,l.bo)((0,l.Lk)("textarea",{ref:"textarea","onUpdate:modelValue":t[2]||(t[2]=e=>n.draftText=e),class:"quote-block__textarea",placeholder:"Текст цитаты...",rows:"3"},null,512),[[o.Jo,n.draftText]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.draftAuthor=e),type:"text",class:"quote-block__input",placeholder:"Автор цитаты",onKeyup:t[4]||(t[4]=(0,o.jR)((...e)=>d.save&&d.save(...e),["enter"]))},null,544),[[o.Jo,n.draftAuthor]]),(0,l.Lk)("div",at,[(0,l.Lk)("button",{class:"quote-block__done",onClick:t[5]||(t[5]=(...e)=>d.save&&d.save(...e))},[(0,l.bF)(c.w,{icon:"mdi-check",size:"20"}),t[7]||(t[7]=(0,l.eW)(" Готово ",-1))])]),(0,l.Lk)("button",{class:"quote-block__cancel",onClick:t[6]||(t[6]=(...e)=>d.cancel&&d.cancel(...e))},[(0,l.bF)(c.w,{icon:"mdi-close",size:"18"})])])):((0,l.uX)(),(0,l.CE)("div",{key:0,class:"quote-block__view",onClick:t[1]||(t[1]=(...e)=>d.startEdit&&d.startEdit(...e))},[(0,l.Lk)("div",lt,[(0,l.bF)(c.w,{icon:"mdi-format-quote-open",size:"24",class:"quote-block__quote-icon"}),(0,l.Lk)("p",ot,(0,s.v_)(i.block.text||"Нажмите для добавления цитаты..."),1),i.block.author?((0,l.uX)(),(0,l.CE)("span",st,"— "+(0,s.v_)(i.block.author),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("button",{class:"quote-block__menu",onClick:t[0]||(t[0]=(0,o.D$)(t=>e.$emit("delete"),["stop"]))},[(0,l.bF)(c.w,{icon:"mdi-dots-vertical",size:"18"})])]))],2)}var dt={name:"QuoteBlock",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],data(){return{editing:!1,draftText:"",draftAuthor:""}},methods:{startEdit(){this.draftText=this.block.text||"",this.draftAuthor=this.block.author||"",this.editing=!0,this.$nextTick(()=>{this.$refs.textarea?.focus()})},async save(){if(this.draftText===this.block.text&&this.draftAuthor===this.block.author)return void(this.editing=!1);const e=window.scrollX,t=window.scrollY;try{await v.xt.updateBlock(this.pageId,this.block.id,{type:"QUOTE",text:this.draftText,author:this.draftAuthor}),this.$emit("update",{...this.block,text:this.draftText,author:this.draftAuthor})}catch(i){console.error("Failed to update quote:",i)}this.editing=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancel(){this.editing=!1}}};const rt=(0,g.A)(dt,[["render",nt],["__scopeId","data-v-03f27e1e"]]);var kt=rt;const ut={TEXT:w,HEADING:F,DIVIDER:z,CHECKLIST:Q,BULLET_LIST:ee,KEY_VALUE:re,IDEA_CARD:we,PROS:De,CONS:Pe,LINK:Ne,STATUS:it,QUOTE:kt};var bt={name:"BlockRenderer",props:{block:{type:Object,required:!0},pageId:{type:String,required:!0}},emits:["update","delete"],computed:{blockComponent(){const e=this.block.type||this.block.blockType;return ut[e]||w}}};const pt=(0,g.A)(bt,[["render",b]]);var ht=pt;const mt={key:0,class:"block-menu"},_t={class:"block-menu__search"},vt={class:"block-menu__list"},ft={key:0,class:"block-menu__empty"},gt={key:1,class:"block-menu__section"},yt=["onClick","onMouseenter"],wt={class:"block-menu__item-icon"},Ct={class:"block-menu__item-info"},Lt={class:"block-menu__item-name"},xt={class:"block-menu__item-desc"},It={key:2,class:"block-menu__section"},Tt={class:"block-menu__section-title"},Et={key:0,class:"block-menu__pro-badge"},Bt=["onClick","onMouseenter"],Ft={class:"block-menu__item-info"},Dt={class:"block-menu__item-name"},Xt={class:"block-menu__item-desc"};function $t(e,t,i,a,n,d){return(0,l.uX)(),(0,l.Wv)(l.Im,{to:"body"},[(0,l.bF)(o.eB,{name:"fade"},{default:(0,l.k6)(()=>[i.show?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"block-menu__overlay",onClick:t[6]||(t[6]=(0,o.D$)(t=>e.$emit("close"),["self"]))},[(0,l.bF)(o.eB,{name:"scale"},{default:(0,l.k6)(()=>[i.show?((0,l.uX)(),(0,l.CE)("div",mt,[(0,l.Lk)("div",_t,[(0,l.bF)(c.w,{icon:"mdi-magnify",size:"18",class:"block-menu__search-icon"}),(0,l.bo)((0,l.Lk)("input",{ref:"searchInput","onUpdate:modelValue":t[0]||(t[0]=e=>n.search=e),type:"text",class:"block-menu__search-input",placeholder:"Поиск блоков...",onKeydown:[t[1]||(t[1]=(0,o.jR)((0,o.D$)((...e)=>d.navigateDown&&d.navigateDown(...e),["prevent"]),["down"])),t[2]||(t[2]=(0,o.jR)((0,o.D$)((...e)=>d.navigateUp&&d.navigateUp(...e),["prevent"]),["up"])),t[3]||(t[3]=(0,o.jR)((0,o.D$)((...e)=>d.selectCurrent&&d.selectCurrent(...e),["prevent"]),["enter"])),t[4]||(t[4]=(0,o.jR)(t=>e.$emit("close"),["escape"]))]},null,544),[[o.Jo,n.search]])]),(0,l.Lk)("div",vt,[0===d.filteredBlocks.length?((0,l.uX)(),(0,l.CE)("div",ft," Ничего не найдено ")):(0,l.Q3)("",!0),d.filteredFreeBlocks.length>0?((0,l.uX)(),(0,l.CE)("div",gt,[t[7]||(t[7]=(0,l.Lk)("div",{class:"block-menu__section-title"},"Основные",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.filteredFreeBlocks,(e,t)=>((0,l.uX)(),(0,l.CE)("button",{key:e.blockType,class:(0,s.C4)(["block-menu__item",{"block-menu__item--active":n.selectedIndex===t}]),onClick:t=>d.select(e),onMouseenter:e=>n.selectedIndex=t},[(0,l.Lk)("div",wt,[(0,l.bF)(c.w,{icon:d.getIcon(e.blockType),size:"20"},null,8,["icon"])]),(0,l.Lk)("div",Ct,[(0,l.Lk)("span",Lt,(0,s.v_)(e.blockName),1),(0,l.Lk)("span",xt,(0,s.v_)(d.getDescription(e.blockType)),1)])],42,yt))),128))])):(0,l.Q3)("",!0),d.filteredPremiumBlocks.length>0?((0,l.uX)(),(0,l.CE)("div",It,[(0,l.Lk)("div",Tt,[t[8]||(t[8]=(0,l.eW)(" Премиум ",-1)),i.isPremium?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("span",Et,"PRO"))]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.filteredPremiumBlocks,(e,t)=>((0,l.uX)(),(0,l.CE)("button",{key:e.blockType,class:(0,s.C4)(["block-menu__item",{"block-menu__item--active":n.selectedIndex===d.filteredFreeBlocks.length+t,"block-menu__item--locked":!i.isPremium}]),onClick:t=>d.select(e),onMouseenter:e=>n.selectedIndex=d.filteredFreeBlocks.length+t},[(0,l.Lk)("div",{class:(0,s.C4)(["block-menu__item-icon",{"block-menu__item-icon--premium":!i.isPremium}])},[(0,l.bF)(c.w,{icon:d.getIcon(e.blockType),size:"20"},null,8,["icon"])],2),(0,l.Lk)("div",Ft,[(0,l.Lk)("span",Dt,(0,s.v_)(e.blockName),1),(0,l.Lk)("span",Xt,(0,s.v_)(d.getDescription(e.blockType)),1)]),i.isPremium?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(c.w,{key:0,icon:"mdi-lock",size:"14",class:"block-menu__item-lock"}))],42,Bt))),128))])):(0,l.Q3)("",!0)]),!i.isPremium&&d.filteredPremiumBlocks.length>0?((0,l.uX)(),(0,l.CE)("button",{key:0,class:"block-menu__upgrade",onClick:t[5]||(t[5]=(...e)=>d.goToPlans&&d.goToPlans(...e))},[(0,l.bF)(c.w,{icon:"mdi-crown",size:"16"}),t[9]||(t[9]=(0,l.Lk)("span",null,"Разблокировать все блоки",-1)),(0,l.bF)(c.w,{icon:"mdi-arrow-right",size:"16"})])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)]),_:1})])):(0,l.Q3)("",!0)]),_:1})])}i(2489);const St={TEXT:"mdi-text",HEADING:"mdi-format-header-1",DIVIDER:"mdi-minus",CHECKLIST:"mdi-checkbox-marked-outline",BULLET_LIST:"mdi-format-list-bulleted",KEY_VALUE:"mdi-table-row",IDEA_CARD:"mdi-lightbulb-outline",PROS:"mdi-thumb-up-outline",CONS:"mdi-thumb-down-outline",LINK:"mdi-link-variant",STATUS:"mdi-flag-outline",QUOTE:"mdi-format-quote-close"},zt={TEXT:"Простой текстовый блок",HEADING:"Заголовок H1, H2, H3",DIVIDER:"Горизонтальный разделитель",CHECKLIST:"Список задач с галочками",BULLET_LIST:"Маркированный список",KEY_VALUE:"Пары ключ-значение",IDEA_CARD:"Структурированная идея",PROS:"Преимущество / плюс",CONS:"Недостаток / минус",LINK:"Ссылка на ресурс",STATUS:"Статус задачи",QUOTE:"Цитата с автором"};var Ut={name:"BlockTypeSelector",props:{show:{type:Boolean,default:!1},blockTypes:{type:Array,default:()=>[]},isPremium:{type:Boolean,default:!1}},emits:["close","select"],data(){return{search:"",selectedIndex:0}},computed:{filteredBlocks(){if(!this.search.trim())return this.blockTypes;const e=this.search.toLowerCase();return this.blockTypes.filter(t=>t.blockName.toLowerCase().includes(e)||this.getDescription(t.blockType).toLowerCase().includes(e))},filteredFreeBlocks(){return this.filteredBlocks.filter(e=>e.isFreeBlock)},filteredPremiumBlocks(){return this.filteredBlocks.filter(e=>!e.isFreeBlock)}},watch:{show(e){e&&(this.search="",this.selectedIndex=0,this.$nextTick(()=>{this.$refs.searchInput?.focus()}))},search(){this.selectedIndex=0}},methods:{getIcon(e){return St[e]||"mdi-card-outline"},getDescription(e){return zt[e]||""},select(e){e.isFreeBlock||this.isPremium?this.$emit("select",e.blockType):this.goToPlans()},navigateDown(){const e=this.filteredBlocks.length;e>0&&(this.selectedIndex=(this.selectedIndex+1)%e)},navigateUp(){const e=this.filteredBlocks.length;e>0&&(this.selectedIndex=(this.selectedIndex-1+e)%e)},selectCurrent(){const e=this.filteredBlocks[this.selectedIndex];e&&this.select(e)},goToPlans(){this.$emit("close"),this.$router.push({name:"subscription-plans"})}}};const At=(0,g.A)(Ut,[["render",$t],["__scopeId","data-v-eeb05008"]]);var qt=At,Kt=i(6844);const Pt={key:0,class:"confirm-dialog"},Rt={class:"confirm-dialog__title"},Vt={key:0,class:"confirm-dialog__message"},Ot={class:"confirm-dialog__actions"};function jt(e,t,i,c,a,n){return(0,l.uX)(),(0,l.Wv)(l.Im,{to:"body"},[(0,l.bF)(o.eB,{name:"fade"},{default:(0,l.k6)(()=>[i.show?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"confirm-dialog__overlay",onClick:t[2]||(t[2]=(0,o.D$)(t=>e.$emit("cancel"),["self"]))},[(0,l.bF)(o.eB,{name:"slide-up"},{default:(0,l.k6)(()=>[i.show?((0,l.uX)(),(0,l.CE)("div",Pt,[(0,l.Lk)("h3",Rt,(0,s.v_)(i.title),1),i.message?((0,l.uX)(),(0,l.CE)("p",Vt,(0,s.v_)(i.message),1)):(0,l.Q3)("",!0),(0,l.Lk)("div",Ot,[(0,l.Lk)("button",{class:"confirm-dialog__btn confirm-dialog__btn--cancel",onClick:t[0]||(t[0]=t=>e.$emit("cancel"))},(0,s.v_)(i.cancelText),1),(0,l.Lk)("button",{class:(0,s.C4)(["confirm-dialog__btn",{"confirm-dialog__btn--danger":i.danger}]),onClick:t[1]||(t[1]=t=>e.$emit("confirm"))},(0,s.v_)(i.confirmText),3)])])):(0,l.Q3)("",!0)]),_:1})])):(0,l.Q3)("",!0)]),_:1})])}var Qt={name:"ConfirmDialog",props:{show:{type:Boolean,default:!1},title:{type:String,required:!0},message:{type:String,default:""},confirmText:{type:String,default:"Удалить"},cancelText:{type:String,default:"Отмена"},danger:{type:Boolean,default:!1}},emits:["confirm","cancel"]};const Ht=(0,g.A)(Qt,[["render",jt],["__scopeId","data-v-49d6e655"]]);var Wt=Ht,Nt={name:"PageDetailView",components:{BlockRenderer:ht,BlockTypeSelector:qt,EmptyState:Kt.A,ConfirmDialog:Wt},data(){return{loading:!0,page:null,editingTitle:!1,titleDraft:"",showBlockSelector:!1,showDeleteConfirm:!1,showBlockDeleteConfirm:!1,blockToDelete:null,blockIndexToDelete:null,blockTypes:[],isPremium:!1}},computed:{pageId(){return this.$route.params.id}},async mounted(){await this.loadData()},methods:{async loadData(){try{this.loading=!0;const[e,t,i]=await Promise.all([v.v0.getPage(this.pageId),v.v0.getBlockTypes(),v.eS.getCurrent()]);this.page=e.data,console.log("Loaded page data:",this.page),console.log("Page blocks:",this.page.blocks),console.log("Block types response:",t.data),this.blockTypes=t.data.blocks||[],console.log("Loaded blockTypes:",this.blockTypes),this.isPremium="PREMIUM"===i.data.plan}catch(e){console.error("Failed to load page:",e),this.$router.replace({name:"pages"})}finally{this.loading=!1}},goBack(){this.$router.push({name:"pages"})},startTitleEdit(){this.titleDraft=this.page?.title||"",this.editingTitle=!0,this.$nextTick(()=>{this.$refs.titleInput?.focus(),this.$refs.titleInput?.select()})},async saveTitle(){if(this.titleDraft.trim()||(this.titleDraft=this.page?.title||""),this.titleDraft===this.page?.title)return void(this.editingTitle=!1);const e=window.scrollX,t=window.scrollY;try{await v.v0.updatePage(this.pageId,{title:this.titleDraft.trim()}),this.page.title=this.titleDraft.trim()}catch(i){console.error("Failed to update title:",i)}this.editingTitle=!1,this.$nextTick(()=>{window.scrollTo(e,t)})},cancelTitleEdit(){this.editingTitle=!1},async createBlock(e){this.showBlockSelector=!1;const t=this.getDefaultBlockPayload(e);console.log("Creating block with payload:",t);try{const e=await v.xt.createBlock(this.pageId,t);console.log("Block created, response:",e.data),this.page.blocks.push(e.data)}catch(i){console.error("Failed to create block:",i)}},getDefaultBlockPayload(e){switch(e){case"TEXT":case"PROS":case"CONS":return{type:e,textContent:""};case"HEADING":return{type:e,header:"",level:1};case"DIVIDER":return{type:e};case"CHECKLIST":return{type:e,items:[{text:"",status:!1}]};case"BULLET_LIST":return{type:e,items:[""]};case"KEY_VALUE":return{type:e,items:[{key:"",value:""}]};case"IDEA_CARD":return{type:e,problem:"",solution:"",audience:"",mvp:"",monetization:""};case"LINK":return{type:e,url:"",text:""};case"STATUS":return{type:e,status:"IDEA"};case"QUOTE":return{type:e,text:"",author:""};default:return{type:e}}},updateBlock(e,t){this.page.blocks[e]=t},deleteBlock(e,t){this.blockToDelete=e,this.blockIndexToDelete=t,this.showBlockDeleteConfirm=!0},async confirmDeleteBlock(){if(this.blockToDelete){try{await v.xt.deleteBlock(this.pageId,this.blockToDelete.id),this.page.blocks.splice(this.blockIndexToDelete,1)}catch(e){console.error("Failed to delete block:",e)}this.blockToDelete=null,this.blockIndexToDelete=null,this.showBlockDeleteConfirm=!1}},cancelDeleteBlock(){this.blockToDelete=null,this.blockIndexToDelete=null,this.showBlockDeleteConfirm=!1},async deletePage(){try{await v.v0.deletePage(this.pageId),this.$router.replace({name:"pages"})}catch(e){console.error("Failed to delete page:",e)}this.showDeleteConfirm=!1}}};const Jt=(0,g.A)(Nt,[["render",u],["__scopeId","data-v-001fddb6"]]);var Yt=Jt},6844:function(e,t,i){i.d(t,{A:function(){return p}});var l=i(6768),o=i(4232),s=i(365);const c={class:"empty-state"},a={class:"empty-state__icon-wrapper"},n={class:"empty-state__title"},d={key:0,class:"empty-state__subtitle"};function r(e,t,i,r,k,u){return(0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",a,[(0,l.bF)(s.w,{icon:i.icon,size:"48",class:"empty-state__icon"},null,8,["icon"])]),(0,l.Lk)("h3",n,(0,o.v_)(i.title),1),i.subtitle?((0,l.uX)(),(0,l.CE)("p",d,(0,o.v_)(i.subtitle),1)):(0,l.Q3)("",!0),i.actionText?((0,l.uX)(),(0,l.CE)("button",{key:1,class:"empty-state__action",onClick:t[0]||(t[0]=t=>e.$emit("action"))},(0,o.v_)(i.actionText),1)):(0,l.Q3)("",!0)])}var k={name:"EmptyState",props:{icon:{type:String,default:"mdi-note-outline"},title:{type:String,required:!0},subtitle:{type:String,default:""},actionText:{type:String,default:""}},emits:["action"]},u=i(1241);const b=(0,u.A)(k,[["render",r],["__scopeId","data-v-5b7a5deb"]]);var p=b}}]);
//# sourceMappingURL=page-detail.a19fcab6.js.map