"use strict";(self["webpackChunkmini_notes_ui"]=self["webpackChunkmini_notes_ui"]||[]).push([[687],{1335:function(a,e,n){n.r(e),n.d(e,{default:function(){return M}});var l=n(6768),s=n(5130),r=n(4232),i=n(365);const c={class:"plans-page"},t={class:"plans-header"},p={class:"plans-content"},o={key:0,class:"plans-loading"},d={class:"plans-features"},u={class:"plans-features__table"},_={class:"plans-features__label"},k={class:"plans-features__value"},m={class:"plans-features__value plans-features__value--pro"};function v(a,e,n,v,b,f){const C=(0,l.g2)("PlanCard");return(0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",t,[(0,l.Lk)("button",{class:"plans-header__back",onClick:e[0]||(e[0]=(...a)=>f.goBack&&f.goBack(...a))},[(0,l.bF)(i.w,{icon:"mdi-arrow-left",size:"24"})]),e[1]||(e[1]=(0,l.Lk)("div",{class:"plans-header__content"},[(0,l.Lk)("h1",{class:"plans-header__title"},"Выберите план"),(0,l.Lk)("p",{class:"plans-header__subtitle"},"Разблокируйте все возможности")],-1))]),(0,l.Lk)("div",p,[b.loading?((0,l.uX)(),(0,l.CE)("div",o,[...e[2]||(e[2]=[(0,l.Lk)("div",{class:"plans-loading__spinner"},null,-1)])])):((0,l.uX)(),(0,l.Wv)(s.F,{key:1,name:"fade-up",tag:"div",class:"plans-list"},{default:(0,l.k6)(()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.plans,(a,e)=>((0,l.uX)(),(0,l.Wv)(C,{key:a.id,plan:a,"is-current":f.isPlanCurrent(a),style:(0,r.Tr)({transitionDelay:.1*e+"s"}),onSelect:e=>f.selectPlan(a)},null,8,["plan","is-current","style","onSelect"]))),128))]),_:1}))]),(0,l.Lk)("div",d,[e[4]||(e[4]=(0,l.Lk)("h3",{class:"plans-features__title"},"Сравнение планов",-1)),(0,l.Lk)("div",u,[e[3]||(e[3]=(0,l.Lk)("div",{class:"plans-features__row plans-features__row--header"},[(0,l.Lk)("span"),(0,l.Lk)("span",null,"Free"),(0,l.Lk)("span",null,"Pro")],-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(b.comparisonFeatures,(a,e)=>((0,l.uX)(),(0,l.CE)("div",{class:"plans-features__row",key:e},[(0,l.Lk)("span",_,(0,r.v_)(a.label),1),(0,l.Lk)("span",k,(0,r.v_)(a.free),1),(0,l.Lk)("span",m,(0,r.v_)(a.pro),1)]))),128))])])])}const b={key:0,class:"plan-card__badge"},f={key:1,class:"plan-card__glow"},C={class:"plan-card__header"},h={class:"plan-card__title-group"},w={class:"plan-card__name"},y={class:"plan-card__description"},L={class:"plan-card__price"},g={key:0,class:"plan-card__price-value"},P={key:1,class:"plan-card__price-free"},E={key:2,class:"plan-card__price-period"},X={class:"plan-card__features"},F=["disabled"],A={key:0},S={key:1},T={key:2},W={key:2,class:"plan-card__current-indicator"};function I(a,e,n,s,c,t){return(0,l.uX)(),(0,l.CE)("div",{class:(0,r.C4)(["plan-card",{"plan-card--premium":t.isPremium,"plan-card--current":n.isCurrent}]),onClick:e[0]||(e[0]=e=>a.$emit("select"))},[n.plan.popular?((0,l.uX)(),(0,l.CE)("div",b,[(0,l.bF)(i.w,{icon:"mdi-fire",size:"12"}),e[1]||(e[1]=(0,l.eW)(" Популярный ",-1))])):(0,l.Q3)("",!0),t.isPremium?((0,l.uX)(),(0,l.CE)("div",f)):(0,l.Q3)("",!0),(0,l.Lk)("div",C,[(0,l.Lk)("div",{class:(0,r.C4)(["plan-card__icon",{"plan-card__icon--premium":t.isPremium}])},[(0,l.bF)(i.w,{icon:t.isPremium?"mdi-crown":"mdi-leaf",size:"24"},null,8,["icon"])],2),(0,l.Lk)("div",h,[(0,l.Lk)("span",w,(0,r.v_)(n.plan.name),1),(0,l.Lk)("span",y,(0,r.v_)(t.planDescription),1)])]),(0,l.Lk)("div",L,[n.plan.priceStars>0?((0,l.uX)(),(0,l.CE)("span",g,[(0,l.eW)((0,r.v_)(n.plan.priceStars)+" ",1),e[2]||(e[2]=(0,l.Lk)("span",{class:"plan-card__price-currency"},"⭐",-1))])):((0,l.uX)(),(0,l.CE)("span",P,"Бесплатно")),n.plan.durationDays?((0,l.uX)(),(0,l.CE)("span",E,"/ "+(0,r.v_)(t.periodLabel),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("ul",X,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.plan.features,(a,e)=>((0,l.uX)(),(0,l.CE)("li",{key:e,class:"plan-card__feature"},[(0,l.bF)(i.w,{icon:"mdi-check-circle",size:"18",class:"plan-card__feature-icon"}),(0,l.Lk)("span",null,(0,r.v_)(a),1)]))),128))]),(0,l.Lk)("button",{class:(0,r.C4)(["plan-card__button",{"plan-card__button--premium":t.isPremium&&!n.isCurrent}]),disabled:n.isCurrent},[n.isCurrent?((0,l.uX)(),(0,l.CE)("span",A,"Текущий план")):t.isPremium?((0,l.uX)(),(0,l.CE)("span",S,"Оплатить "+(0,r.v_)(n.plan.priceStars)+" ⭐",1)):((0,l.uX)(),(0,l.CE)("span",T,"Начать бесплатно"))],10,F),n.isCurrent?((0,l.uX)(),(0,l.CE)("div",W,[(0,l.bF)(i.w,{icon:"mdi-check-circle",size:"16"}),e[3]||(e[3]=(0,l.eW)(" Активен ",-1))])):(0,l.Q3)("",!0)],2)}var D={name:"PlanCard",props:{plan:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1}},computed:{isPremium(){return this.plan.priceStars>0},periodLabel(){const a=this.plan.durationDays;return 30===a||31===a?"месяц":365===a||366===a?"год":7===a?"неделя":`${a} дн.`},planDescription(){return 0===this.plan.priceStars?"Для начала работы с заметками":"Полный доступ ко всем функциям"}}},z=n(1241);const B=(0,z.A)(D,[["render",I],["__scopeId","data-v-12a8d7d6"]]);var Q=B,K=n(1668),R={name:"SubscriptionPlansView",components:{PlanCard:Q},data(){return{loading:!0,currentPlanType:"FREE",plans:[],comparisonFeatures:[{label:"Страницы",free:"5",pro:"∞"},{label:"Блоки",free:"10",pro:"∞"},{label:"Экспорт",free:"—",pro:"✓"},{label:"Синхронизация",free:"—",pro:"✓"},{label:"Поддержка",free:"—",pro:"✓"}]}},async mounted(){await this.loadData()},methods:{async loadData(){try{this.loading=!0;const[a,e]=await Promise.all([K.eS.getPlans(),K.eS.getCurrent()]);this.plans=a.data,this.currentPlanType=e.data.plan}catch(a){console.error("Failed to load data:",a)}finally{this.loading=!1}},goBack(){this.$router.back()},isPlanCurrent(a){return 0===a.priceStars?"FREE"===this.currentPlanType:"PREMIUM"===this.currentPlanType},async selectPlan(a){if(!this.isPlanCurrent(a)&&0!==a.priceStars)try{const e=await K.eS.createInvoice({planId:a.id}),n=e.data.invoiceLink;window.Telegram?.WebApp?.openInvoice?window.Telegram.WebApp.openInvoice(n,a=>{"paid"===a?(this.loadData(),window.Telegram.WebApp.showAlert("Подписка успешно оформлена!")):"cancelled"===a?console.log("Payment cancelled"):"failed"===a&&window.Telegram.WebApp.showAlert("Ошибка оплаты. Попробуйте позже.")}):(console.log("Telegram WebApp not available, invoice link:",n),alert("Для оплаты откройте приложение в Telegram"))}catch(e){console.error("Failed to create invoice:",e),window.Telegram?.WebApp?.showAlert&&window.Telegram.WebApp.showAlert("Не удалось создать счёт. Попробуйте позже.")}}}};const $=(0,z.A)(R,[["render",v],["__scopeId","data-v-38b834d4"]]);var M=$}}]);
//# sourceMappingURL=subscription-plans.ed04f0cc.js.map